define(["@grafana/data","lodash","rxjs","@grafana/runtime","@grafana/ui","react","@emotion/css","redux"],((e,t,n,r,l,i,a,o)=>(()=>{var s={853:(e,t,n)=>{var r,l,i,a,o,s,u,c,f,p,d=n(388),g=n(650),y=(r=g)&&"object"==typeof r&&"default"in r?r.default:r,m=(n(305),n(545),n(644)),v=function(){return(v=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)};function h(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(r=Object.getOwnPropertySymbols(e);l<r.length;l++)t.indexOf(r[l])<0&&Object.prototype.propertyIsEnumerable.call(e,r[l])&&(n[r[l]]=e[r[l]])}return n}function E(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,l,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){l={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(l)throw l.error}}return a}function b(e,t,n){if(n||2===arguments.length)for(var r,l=0,i=t.length;l<i;l++)!r&&l in t||(r||(r=Array.prototype.slice.call(t,0,l)),r[l]=t[l]);return e.concat(r||Array.prototype.slice.call(t))}(l=t.$M||(t.$M={}))[l.Comparison=0]="Comparison",l[l.Logical=1]="Logical",(i=t.mB||(t.mB={}))[i.Value=0]="Value",i[i.Filter=1]="Filter",i[i.Group=2]="Group",i[i.Column=3]="Column",i[i.Table=4]="Table",(a=t.iv||(t.iv={})).Parenthesis="delimiter.parenthesis.sql",a.Whitespace="white.sql",a.Keyword="keyword.sql",a.Delimiter="delimiter.sql",a.Operator="operator.sql",a.Identifier="identifier.sql",a.IdentifierQuote="identifier.quote.sql",a.Type="type.sql",a.Function="predefined.sql",a.Number="number.sql",a.String="string.sql",a.Variable="variable.sql",(o=t.fC||(t.fC={})).Unknown="unknown",o.SelectKeyword="selectKeyword",o.WithKeyword="withKeyword",o.AfterSelectKeyword="afterSelectKeyword",o.AfterSelectArguments="afterSelectArguments",o.AfterSelectFuncFirstArgument="afterSelectFuncFirstArgument",o.SelectAlias="selectAlias",o.AfterFromKeyword="afterFromKeyword",o.AfterTable="afterTable",o.SchemaFuncFirstArgument="schemaFuncFirstArgument",o.SchemaFuncExtraArgument="schemaFuncExtraArgument",o.FromKeyword="fromKeyword",o.AfterFrom="afterFrom",o.WhereKeyword="whereKeyword",o.WhereComparisonOperator="whereComparisonOperator",o.WhereValue="whereValue",o.AfterWhereFunctionArgument="afterWhereFunctionArgument",o.AfterGroupByFunctionArgument="afterGroupByFunctionArgument",o.AfterWhereValue="afterWhereValue",o.AfterGroupByKeywords="afterGroupByKeywords",o.AfterGroupBy="afterGroupBy",o.AfterOrderByKeywords="afterOrderByKeywords",o.AfterOrderByFunction="afterOrderByFunction",o.AfterOrderByDirection="afterOrderByDirection",o.AfterIsOperator="afterIsOperator",o.AfterIsNotOperator="afterIsNotOperator",o.AfterSchema="afterSchema",(s=t.is||(t.is={})).Schemas="schemas",s.Tables="tables",s.Columns="columns",s.SelectKeyword="selectKeyword",s.WithKeyword="withKeyword",s.FunctionsWithArguments="functionsWithArguments",s.FromKeyword="fromKeyword",s.WhereKeyword="whereKeyword",s.GroupByKeywords="groupByKeywords",s.OrderByKeywords="orderByKeywords",s.FunctionsWithoutArguments="functionsWithoutArguments",s.LimitKeyword="limitKeyword",s.SortOrderDirectionKeyword="sortOrderDirectionKeyword",s.ComparisonOperators="comparisonOperators",s.LogicalOperators="logicalOperators",s.SelectMacro="selectMacro",s.TableMacro="tableMacro",s.FilterMacro="filterMacro",s.GroupMacro="groupMacro",s.BoolValues="boolValues",s.NullValue="nullValue",s.NotKeyword="notKeyword",s.TemplateVariables="templateVariables",s.StarWildCard="starWildCard",(u=t.G8||(t.G8={})).High="a",u.MediumHigh="d",u.Medium="g",u.MediumLow="k",u.Low="q",(c=t.cm||(t.cm={}))[c.Method=0]="Method",c[c.Function=1]="Function",c[c.Constructor=2]="Constructor",c[c.Field=3]="Field",c[c.Variable=4]="Variable",c[c.Class=5]="Class",c[c.Struct=6]="Struct",c[c.Interface=7]="Interface",c[c.Module=8]="Module",c[c.Property=9]="Property",c[c.Event=10]="Event",c[c.Operator=11]="Operator",c[c.Unit=12]="Unit",c[c.Value=13]="Value",c[c.Constant=14]="Constant",c[c.Enum=15]="Enum",c[c.EnumMember=16]="EnumMember",c[c.Keyword=17]="Keyword",c[c.Text=18]="Text",c[c.Color=19]="Color",c[c.File=20]="File",c[c.Reference=21]="Reference",c[c.Customcolor=22]="Customcolor",c[c.Folder=23]="Folder",c[c.TypeParameter=24]="TypeParameter",c[c.User=25]="User",c[c.Issue=26]="Issue",c[c.Snippet=27]="Snippet",(f=t.a7||(t.a7={}))[f.KeepWhitespace=1]="KeepWhitespace",f[f.InsertAsSnippet=4]="InsertAsSnippet",(p=t.je||(t.je={})).Builder="builder",p.Code="code";!function(){function e(e,t,n,r,l){this.type=e,this.value=t,this.range=n,this.previous=r,this.next=l}e.prototype.isKeyword=function(){return this.type===t.iv.Keyword},e.prototype.isWhiteSpace=function(){return this.type===t.iv.Whitespace},e.prototype.isParenthesis=function(){return this.type===t.iv.Parenthesis},e.prototype.isIdentifier=function(){return this.type===t.iv.Identifier},e.prototype.isString=function(){return this.type===t.iv.String},e.prototype.isNumber=function(){return this.type===t.iv.Number},e.prototype.isDoubleQuotedString=function(){return this.type===t.iv.Type},e.prototype.isVariable=function(){return this.type===t.iv.Variable},e.prototype.isFunction=function(){return this.type===t.iv.Function},e.prototype.isOperator=function(){return this.type===t.iv.Operator},e.prototype.isTemplateVariable=function(){return this.type===t.iv.Variable},e.prototype.is=function(e,t){var n=this.type===e;return void 0!==t?n&&q(e,this,t):n},e.prototype.getPreviousNonWhiteSpaceToken=function(){for(var e=this.previous;null!=e;){if(!e.isWhiteSpace())return e;e=e.previous}return null},e.prototype.getPreviousOfType=function(e,t){for(var n=this.previous;null!=n;){var r=n.type===e;if(void 0!==t?r&&q(e,n,t):r)return n;n=n.previous}return null},e.prototype.getPreviousUntil=function(e,t,n){for(var r=[],l=this.previous;null!=l;)if(t.some((function(e){return e===(null==l?void 0:l.type)})))l=l.previous;else{var i=l.type===e;if(void 0!==n?i&&q(e,l,n):i)return r;l.isWhiteSpace()||r.push(l),l=l.previous}return r},e.prototype.getNextUntil=function(e,t,n){for(var r=[],l=this.next;null!=l;)if(t.some((function(e){return e===(null==l?void 0:l.type)})))l=l.next;else{var i=l.type===e;if(void 0!==n?i&&q(e,l,n):i)return r;l.isWhiteSpace()||r.push(l),l=l.next}return r},e.prototype.getPreviousKeyword=function(){for(var e=this.previous;null!=e;){if(e.isKeyword())return e;e=e.previous}return null},e.prototype.getNextNonWhiteSpaceToken=function(){for(var e=this.next;null!=e;){if(!e.isWhiteSpace())return e;e=e.next}return null},e.prototype.getNextOfType=function(e,t){for(var n=this.next;null!=n;){var r=n.type===e;if(void 0!==t?r&&q(e,n,t):r)return n;n=n.next}return null}}();function q(e,n,r){return e===t.iv.Keyword||e===t.iv.Operator?n.value.toLowerCase()===r.toString().toLowerCase():n.value===r}var O="select",w="from",S="by",T="desc",A="asc",I=["=","!="],R=b([],E(I),!1);Object.freeze({__proto__:null,SELECT:O,FROM:w,WHERE:"where",GROUP:"group",ORDER:"order",BY:S,DESC:T,ASC:A,LIMIT:"limit",WITH:"with",AS:"as",SCHEMA:"schema",AND:"AND",OR:"OR",LOGICAL_OPERATORS:["AND","OR"],EQUALS:"=",NOT_EQUALS:"!=",COMPARISON_OPERATORS:I,STD_OPERATORS:R,conf:{comments:{lineComment:"--",blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}]},language:{defaultToken:"",tokenPostfix:".sql",ignoreCase:!0,brackets:[{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"}],keywords:["ABORT","ABSOLUTE","ACTION","ADA","ADD","AFTER","ALL","ALLOCATE","ALTER","ALWAYS","ANALYZE","AND","ANY","ARE","AS","ASC","ASSERTION","AT","ATTACH","AUTHORIZATION","AUTOINCREMENT","AVG","BACKUP","BEFORE","BEGIN","BETWEEN","BIT","BIT_LENGTH","BOTH","BREAK","BROWSE","BULK","BY","CASCADE","CASCADED","CASE","CAST","CATALOG","CHAR","CHARACTER","CHARACTER_LENGTH","CHAR_LENGTH","CHECK","CHECKPOINT","CLOSE","CLUSTERED","COALESCE","COLLATE","COLLATION","COLUMN","COMMIT","COMPUTE","CONFLICT","CONNECT","CONNECTION","CONSTRAINT","CONSTRAINTS","CONTAINS","CONTAINSTABLE","CONTINUE","CONVERT","CORRESPONDING","COUNT","CREATE","CROSS","CURRENT","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURSOR","DATABASE","DATE","DAY","DBCC","DEALLOCATE","DEC","DECIMAL","DECLARE","DEFAULT","DEFERRABLE","DEFERRED","DELETE","DENY","DESC","DESCRIBE","DESCRIPTOR","DETACH","DIAGNOSTICS","DISCONNECT","DISK","DISTINCT","DISTRIBUTED","DO","DOMAIN","DOUBLE","DROP","DUMP","EACH","ELSE","END","END-EXEC","ERRLVL","ESCAPE","EXCEPT","EXCEPTION","EXCLUDE","EXCLUSIVE","EXEC","EXECUTE","EXISTS","EXIT","EXPLAIN","EXTERNAL","EXTRACT","FAIL","FALSE","FETCH","FILE","FILLFACTOR","FILTER","FIRST","FLOAT","FOLLOWING","FOR","FOREIGN","FORTRAN","FOUND","FREETEXT","FREETEXTTABLE","FROM","FULL","FUNCTION","GENERATED","GET","GLOB","GLOBAL","GO","GOTO","GRANT","GROUP","GROUPS","HAVING","HOLDLOCK","HOUR","IDENTITY","IDENTITYCOL","IDENTITY_INSERT","IF","IGNORE","IMMEDIATE","IN","INCLUDE","INDEX","INDEXED","INDICATOR","INITIALLY","INNER","INPUT","INSENSITIVE","INSERT","INSTEAD","INT","INTEGER","INTERSECT","INTERVAL","INTO","IS","ISNULL","ISOLATION","JOIN","KEY","KILL","LANGUAGE","LAST","LEADING","LEFT","LEVEL","LIKE","LIMIT","LINENO","LOAD","LOCAL","LOWER","MATCH","MATERIALIZED","MAX","MERGE","MIN","MINUTE","MODULE","MONTH","NAMES","NATIONAL","NATURAL","NCHAR","NEXT","NO","NOCHECK","NONCLUSTERED","NONE","NOT","NOTHING","NOTNULL","NULL","NULLIF","NULLS","NUMERIC","OCTET_LENGTH","OF","OFF","OFFSET","OFFSETS","ON","ONLY","OPEN","OPENDATASOURCE","OPENQUERY","OPENROWSET","OPENXML","OPTION","OR","ORDER","OTHERS","OUTER","OUTPUT","OVER","OVERLAPS","PAD","PARTIAL","PARTITION","PASCAL","PERCENT","PIVOT","PLAN","POSITION","PRAGMA","PRECEDING","PRECISION","PREPARE","PRESERVE","PRIMARY","PRINT","PRIOR","PRIVILEGES","PROC","PROCEDURE","PUBLIC","QUERY","RAISE","RAISERROR","RANGE","READ","READTEXT","REAL","RECONFIGURE","RECURSIVE","REFERENCES","REGEXP","REINDEX","RELATIVE","RELEASE","RENAME","REPLACE","REPLICATION","RESTORE","RESTRICT","RETURN","RETURNING","REVERT","REVOKE","RIGHT","ROLLBACK","ROW","ROWCOUNT","ROWGUIDCOL","ROWS","RULE","SAVE","SAVEPOINT","SCHEMA","SCROLL","SECOND","SECTION","SECURITYAUDIT","SELECT","SEMANTICKEYPHRASETABLE","SEMANTICSIMILARITYDETAILSTABLE","SEMANTICSIMILARITYTABLE","SESSION","SESSION_USER","SET","SETUSER","SHUTDOWN","SIZE","SMALLINT","SOME","SPACE","SQL","SQLCA","SQLCODE","SQLERROR","SQLSTATE","SQLWARNING","STATISTICS","SUBSTRING","SUM","SYSTEM_USER","TABLE","TABLESAMPLE","TEMP","TEMPORARY","TEXTSIZE","THEN","TIES","TIME","TIMESTAMP","TIMEZONE_HOUR","TIMEZONE_MINUTE","TO","TOP","TRAILING","TRAN","TRANSACTION","TRANSLATE","TRANSLATION","TRIGGER","TRIM","TRUE","TRUNCATE","TRY_CONVERT","TSEQUAL","UNBOUNDED","UNION","UNIQUE","UNKNOWN","UNPIVOT","UPDATE","UPDATETEXT","UPPER","USAGE","USE","USER","USING","VACUUM","VALUE","VALUES","VARCHAR","VARYING","VIEW","VIRTUAL","WAITFOR","WHEN","WHENEVER","WHERE","WHILE","WINDOW","WITH","WITHIN GROUP","WITHOUT","WORK","WRITE","WRITETEXT","YEAR","ZONE"],operators:["EXCEPT","INTERSECT","UNION","APPLY","CROSS","FULL","INNER","JOIN","LEFT","OUTER","RIGHT","CONTAINS","FREETEXT","IS","NULL","PIVOT","UNPIVOT","MATCHED"],logicalOperators:["ALL","AND","ANY","BETWEEN","EXISTS","IN","LIKE","NOT","OR","SOME"],comparisonOperators:["<>",">","<",">=","<=","=","!=","&","~","^","%"],builtinFunctions:["AVG","CHECKSUM_AGG","COUNT","COUNT_BIG","GROUPING","GROUPING_ID","MAX","MIN","SUM","STDEV","STDEVP","VAR","VARP","CUME_DIST","FIRST_VALUE","LAG","LAST_VALUE","LEAD","PERCENTILE_CONT","PERCENTILE_DISC","PERCENT_RANK","COLLATE","COLLATIONPROPERTY","TERTIARY_WEIGHTS","FEDERATION_FILTERING_VALUE","CAST","CONVERT","PARSE","TRY_CAST","TRY_CONVERT","TRY_PARSE","ASYMKEY_ID","ASYMKEYPROPERTY","CERTPROPERTY","CERT_ID","CRYPT_GEN_RANDOM","DECRYPTBYASYMKEY","DECRYPTBYCERT","DECRYPTBYKEY","DECRYPTBYKEYAUTOASYMKEY","DECRYPTBYKEYAUTOCERT","DECRYPTBYPASSPHRASE","ENCRYPTBYASYMKEY","ENCRYPTBYCERT","ENCRYPTBYKEY","ENCRYPTBYPASSPHRASE","HASHBYTES","IS_OBJECTSIGNED","KEY_GUID","KEY_ID","KEY_NAME","SIGNBYASYMKEY","SIGNBYCERT","SYMKEYPROPERTY","VERIFYSIGNEDBYCERT","VERIFYSIGNEDBYASYMKEY","CURSOR_STATUS","DATALENGTH","IDENT_CURRENT","IDENT_INCR","IDENT_SEED","IDENTITY","SQL_VARIANT_PROPERTY","CURRENT_TIMESTAMP","DATEADD","DATEDIFF","DATEFROMPARTS","DATENAME","DATEPART","DATETIME2FROMPARTS","DATETIMEFROMPARTS","DATETIMEOFFSETFROMPARTS","DAY","EOMONTH","GETDATE","GETUTCDATE","ISDATE","MONTH","SMALLDATETIMEFROMPARTS","SWITCHOFFSET","SYSDATETIME","SYSDATETIMEOFFSET","SYSUTCDATETIME","TIMEFROMPARTS","TODATETIMEOFFSET","YEAR","CHOOSE","COALESCE","IIF","NULLIF","ABS","ACOS","ASIN","ATAN","ATN2","CEILING","COS","COT","DEGREES","EXP","FLOOR","LOG","LOG10","PI","POWER","RADIANS","RAND","ROUND","SIGN","SIN","SQRT","SQUARE","TAN","APP_NAME","APPLOCK_MODE","APPLOCK_TEST","ASSEMBLYPROPERTY","COL_LENGTH","COL_NAME","COLUMNPROPERTY","DATABASE_PRINCIPAL_ID","DATABASEPROPERTYEX","DB_ID","DB_NAME","FILE_ID","FILE_IDEX","FILE_NAME","FILEGROUP_ID","FILEGROUP_NAME","FILEGROUPPROPERTY","FILEPROPERTY","FULLTEXTCATALOGPROPERTY","FULLTEXTSERVICEPROPERTY","INDEX_COL","INDEXKEY_PROPERTY","INDEXPROPERTY","OBJECT_DEFINITION","OBJECT_ID","OBJECT_NAME","OBJECT_SCHEMA_NAME","OBJECTPROPERTY","OBJECTPROPERTYEX","ORIGINAL_DB_NAME","PARSENAME","SCHEMA_ID","SCHEMA_NAME","SCOPE_IDENTITY","SERVERPROPERTY","STATS_DATE","TYPE_ID","TYPE_NAME","TYPEPROPERTY","DENSE_RANK","NTILE","RANK","ROW_NUMBER","PUBLISHINGSERVERNAME","OPENDATASOURCE","OPENQUERY","OPENROWSET","OPENXML","CERTENCODED","CERTPRIVATEKEY","CURRENT_USER","HAS_DBACCESS","HAS_PERMS_BY_NAME","IS_MEMBER","IS_ROLEMEMBER","IS_SRVROLEMEMBER","LOGINPROPERTY","ORIGINAL_LOGIN","PERMISSIONS","PWDENCRYPT","PWDCOMPARE","SESSION_USER","SESSIONPROPERTY","SUSER_ID","SUSER_NAME","SUSER_SID","SUSER_SNAME","SYSTEM_USER","USER","USER_ID","USER_NAME","ASCII","CHAR","CHARINDEX","CONCAT","DIFFERENCE","FORMAT","LEFT","LEN","LOWER","LTRIM","NCHAR","PATINDEX","QUOTENAME","REPLACE","REPLICATE","REVERSE","RIGHT","RTRIM","SOUNDEX","SPACE","STR","STUFF","SUBSTRING","UNICODE","UPPER","BINARY_CHECKSUM","CHECKSUM","CONNECTIONPROPERTY","CONTEXT_INFO","CURRENT_REQUEST_ID","ERROR_LINE","ERROR_NUMBER","ERROR_MESSAGE","ERROR_PROCEDURE","ERROR_SEVERITY","ERROR_STATE","FORMATMESSAGE","GETANSINULL","GET_FILESTREAM_TRANSACTION_CONTEXT","HOST_ID","HOST_NAME","ISNULL","ISNUMERIC","MIN_ACTIVE_ROWVERSION","NEWID","NEWSEQUENTIALID","ROWCOUNT_BIG","XACT_STATE","TEXTPTR","TEXTVALID","COLUMNS_UPDATED","EVENTDATA","TRIGGER_NESTLEVEL","UPDATE","CHANGETABLE","CHANGE_TRACKING_CONTEXT","CHANGE_TRACKING_CURRENT_VERSION","CHANGE_TRACKING_IS_COLUMN_IN_MASK","CHANGE_TRACKING_MIN_VALID_VERSION","CONTAINSTABLE","FREETEXTTABLE","SEMANTICKEYPHRASETABLE","SEMANTICSIMILARITYDETAILSTABLE","SEMANTICSIMILARITYTABLE","FILETABLEROOTPATH","GETFILENAMESPACEPATH","GETPATHLOCATOR","PATHNAME","GET_TRANSMISSION_STATUS"],builtinVariables:["@@DATEFIRST","@@DBTS","@@LANGID","@@LANGUAGE","@@LOCK_TIMEOUT","@@MAX_CONNECTIONS","@@MAX_PRECISION","@@NESTLEVEL","@@OPTIONS","@@REMSERVER","@@SERVERNAME","@@SERVICENAME","@@SPID","@@TEXTSIZE","@@VERSION","@@CURSOR_ROWS","@@FETCH_STATUS","@@DATEFIRST","@@PROCID","@@ERROR","@@IDENTITY","@@ROWCOUNT","@@TRANCOUNT","@@CONNECTIONS","@@CPU_BUSY","@@IDLE","@@IO_BUSY","@@PACKET_ERRORS","@@PACK_RECEIVED","@@PACK_SENT","@@TIMETICKS","@@TOTAL_ERRORS","@@TOTAL_READ","@@TOTAL_WRITE"],pseudoColumns:["$ACTION","$IDENTITY","$ROWGUID","$PARTITION"],tokenizer:{root:[{include:"@templateVariables"},{include:"@macros"},{include:"@comments"},{include:"@whitespace"},{include:"@pseudoColumns"},{include:"@numbers"},{include:"@strings"},{include:"@complexIdentifiers"},{include:"@scopes"},{include:"@schemaTable"},[/[;,.]/,"delimiter"],[/[()]/,"@brackets"],[/[\w@#$|<|>|=|!|%|&|+|\|-|*|/|~|^]+/,{cases:{"@operators":"operator","@comparisonOperators":"operator","@logicalOperators":"operator","@builtinVariables":"predefined","@builtinFunctions":"predefined","@keywords":"keyword","@default":"identifier"}}]],templateVariables:[[/\$[a-zA-Z0-9]+/,"variable"]],macros:[[/\$__[a-zA-Z0-9-_]+/,"type"]],schemaTable:[[/(\w+)\./,"identifier"],[/(\w+\.\w+)/,"identifier"]],whitespace:[[/\s+/,"white"]],comments:[[/--+.*/,"comment"],[/\/\*/,{token:"comment.quote",next:"@comment"}]],comment:[[/[^*/]+/,"comment"],[/\*\//,{token:"comment.quote",next:"@pop"}],[/./,"comment"]],pseudoColumns:[[/[$][A-Za-z_][\w@#$]*/,{cases:{"@pseudoColumns":"predefined","@default":"identifier"}}]],numbers:[[/0[xX][0-9a-fA-F]*/,"number"],[/[$][+-]*\d*(\.\d*)?/,"number"],[/((\d+(\.\d*)?)|(\.\d+))([eE][\-+]?\d+)?/,"number"]],strings:[[/N'/,{token:"string",next:"@string"}],[/'/,{token:"string",next:"@string"}]],string:[[/[^']+/,"string"],[/''/,"string"],[/'/,{token:"string",next:"@pop"}]],complexIdentifiers:[[/\[/,{token:"identifier.quote",next:"@bracketedIdentifier"}],[/"/,{token:"identifier.quote",next:"@quotedIdentifier"}]],bracketedIdentifier:[[/[^\]]+/,"identifier"],[/]]/,"identifier"],[/]/,{token:"identifier.quote",next:"@pop"}]],quotedIdentifier:[[/[^"]+/,"identifier"],[/""/,"identifier"],[/"/,{token:"identifier.quote",next:"@pop"}]],scopes:[[/BEGIN\s+(DISTRIBUTED\s+)?TRAN(SACTION)?\b/i,"keyword"],[/BEGIN\s+TRY\b/i,{token:"keyword.try"}],[/END\s+TRY\b/i,{token:"keyword.try"}],[/BEGIN\s+CATCH\b/i,{token:"keyword.catch"}],[/END\s+CATCH\b/i,{token:"keyword.catch"}],[/(BEGIN|CASE)\b/i,{token:"keyword.block"}],[/END\b/i,{token:"keyword.block"}],[/WHEN\b/i,{token:"keyword.choice"}],[/THEN\b/i,{token:"keyword.choice"}]]}}}),new Uint8Array(16);for(var P=[],N=0;N<256;++N)P.push((N+256).toString(16).substr(1));var C={logger:function(){}};d.attachDebugger&&d.createLogger&&(C=d.createLogger("SQLEditor"),C.logger,d.attachDebugger("sqleditor",void 0,C));t.mB.Filter,t.mB.Filter,t.mB.Filter,t.mB.Value,t.mB.Table,t.mB.Column;new Map,new Map,Object.freeze({__proto__:null,singleLineFullQuery:{query:'SELECT column1, FROM table1 WHERE column1 = "value1" GROUP BY column1 ORDER BY column1 DESC LIMIT 10',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"identifier.sql",language:"sql"},{offset:14,type:"delimiter.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"},{offset:16,type:"keyword.sql",language:"sql"},{offset:20,type:"white.sql",language:"sql"},{offset:21,type:"identifier.sql",language:"sql"},{offset:27,type:"white.sql",language:"sql"},{offset:28,type:"keyword.sql",language:"sql"},{offset:33,type:"white.sql",language:"sql"},{offset:34,type:"identifier.sql",language:"sql"},{offset:41,type:"white.sql",language:"sql"},{offset:42,type:"operator.sql",language:"sql"},{offset:43,type:"white.sql",language:"sql"},{offset:44,type:"identifier.quote.sql",language:"sql"},{offset:45,type:"identifier.sql",language:"sql"},{offset:51,type:"identifier.quote.sql",language:"sql"},{offset:52,type:"white.sql",language:"sql"},{offset:53,type:"keyword.sql",language:"sql"},{offset:58,type:"white.sql",language:"sql"},{offset:59,type:"keyword.sql",language:"sql"},{offset:61,type:"white.sql",language:"sql"},{offset:62,type:"identifier.sql",language:"sql"},{offset:69,type:"white.sql",language:"sql"},{offset:70,type:"keyword.sql",language:"sql"},{offset:75,type:"white.sql",language:"sql"},{offset:76,type:"keyword.sql",language:"sql"},{offset:78,type:"white.sql",language:"sql"},{offset:79,type:"identifier.sql",language:"sql"},{offset:86,type:"white.sql",language:"sql"},{offset:87,type:"keyword.sql",language:"sql"},{offset:91,type:"white.sql",language:"sql"},{offset:92,type:"keyword.sql",language:"sql"},{offset:97,type:"white.sql",language:"sql"},{offset:98,type:"number.sql",language:"sql"},{offset:100,type:"delimiter.sql",language:"sql"}]]},singleLineFullQueryWithAggregation:{query:'SELECT count(column1), FROM table1 WHERE column1 = "value1" GROUP BY column1 ORDER BY column1 DESC LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"predefined.sql",language:"sql"},{offset:12,type:"delimiter.parenthesis.sql",language:"sql"},{offset:13,type:"identifier.sql",language:"sql"},{offset:20,type:"delimiter.parenthesis.sql",language:"sql"},{offset:21,type:"delimiter.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"keyword.sql",language:"sql"},{offset:27,type:"white.sql",language:"sql"},{offset:28,type:"identifier.sql",language:"sql"},{offset:34,type:"white.sql",language:"sql"},{offset:35,type:"keyword.sql",language:"sql"},{offset:40,type:"white.sql",language:"sql"},{offset:41,type:"identifier.sql",language:"sql"},{offset:48,type:"white.sql",language:"sql"},{offset:49,type:"operator.sql",language:"sql"},{offset:50,type:"white.sql",language:"sql"},{offset:51,type:"identifier.quote.sql",language:"sql"},{offset:52,type:"identifier.sql",language:"sql"},{offset:58,type:"identifier.quote.sql",language:"sql"},{offset:59,type:"white.sql",language:"sql"},{offset:60,type:"keyword.sql",language:"sql"},{offset:65,type:"white.sql",language:"sql"},{offset:66,type:"keyword.sql",language:"sql"},{offset:68,type:"white.sql",language:"sql"},{offset:69,type:"identifier.sql",language:"sql"},{offset:76,type:"white.sql",language:"sql"},{offset:77,type:"keyword.sql",language:"sql"},{offset:82,type:"white.sql",language:"sql"},{offset:83,type:"keyword.sql",language:"sql"},{offset:85,type:"white.sql",language:"sql"},{offset:86,type:"identifier.sql",language:"sql"},{offset:93,type:"white.sql",language:"sql"},{offset:94,type:"keyword.sql",language:"sql"},{offset:98,type:"white.sql",language:"sql"},{offset:99,type:"keyword.sql",language:"sql"},{offset:104,type:"white.sql",language:"sql"},{offset:105,type:"number.sql",language:"sql"},{offset:107,type:"delimiter.sql",language:"sql"}]]},multiLineFullQuery:{query:'SELECT column1,  \n  FROM table1 \n  \n  WHERE column1 = "value1" \n  GROUP BY column1 ORDER BY column1 DESC \n  LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"identifier.sql",language:"sql"},{offset:14,type:"delimiter.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:4,type:"white.sql",language:"sql"},{offset:5,type:"identifier.sql",language:"sql"},{offset:11,type:"white.sql",language:"sql"}],[{offset:0,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"identifier.sql",language:"sql"},{offset:13,type:"white.sql",language:"sql"},{offset:14,type:"operator.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"},{offset:16,type:"identifier.quote.sql",language:"sql"},{offset:17,type:"identifier.sql",language:"sql"},{offset:23,type:"identifier.quote.sql",language:"sql"},{offset:24,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"keyword.sql",language:"sql"},{offset:8,type:"white.sql",language:"sql"},{offset:9,type:"identifier.sql",language:"sql"},{offset:16,type:"white.sql",language:"sql"},{offset:17,type:"keyword.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"keyword.sql",language:"sql"},{offset:25,type:"white.sql",language:"sql"},{offset:26,type:"identifier.sql",language:"sql"},{offset:33,type:"white.sql",language:"sql"},{offset:34,type:"keyword.sql",language:"sql"},{offset:38,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"number.sql",language:"sql"},{offset:8,type:"delimiter.sql",language:"sql"}]]},multiLineFullQueryWithAggregation:{query:'SELECT count(column1),  \n  FROM table1 \n  \n  WHERE column1 = "value1" \n  GROUP BY column1 ORDER BY column1 DESC \n  LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"predefined.sql",language:"sql"},{offset:12,type:"delimiter.parenthesis.sql",language:"sql"},{offset:13,type:"identifier.sql",language:"sql"},{offset:20,type:"delimiter.parenthesis.sql",language:"sql"},{offset:21,type:"delimiter.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:4,type:"white.sql",language:"sql"},{offset:5,type:"identifier.sql",language:"sql"},{offset:11,type:"white.sql",language:"sql"}],[{offset:0,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"identifier.sql",language:"sql"},{offset:13,type:"white.sql",language:"sql"},{offset:14,type:"operator.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"},{offset:16,type:"identifier.quote.sql",language:"sql"},{offset:17,type:"identifier.sql",language:"sql"},{offset:23,type:"identifier.quote.sql",language:"sql"},{offset:24,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"keyword.sql",language:"sql"},{offset:8,type:"white.sql",language:"sql"},{offset:9,type:"identifier.sql",language:"sql"},{offset:16,type:"white.sql",language:"sql"},{offset:17,type:"keyword.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"keyword.sql",language:"sql"},{offset:25,type:"white.sql",language:"sql"},{offset:26,type:"identifier.sql",language:"sql"},{offset:33,type:"white.sql",language:"sql"},{offset:34,type:"keyword.sql",language:"sql"},{offset:38,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"number.sql",language:"sql"},{offset:8,type:"delimiter.sql",language:"sql"}]]},singleLineEmptyQuery:{query:"",tokens:[]},singleLineTwoQueries:{query:'SELECT column1, FROM table1 WHERE column1 = "value1" GROUP BY column1 ORDER BY column1 DESC LIMIT 10; SELECT column2, FROM table2 WHERE column2 = "value2" GROUP BY column1 ORDER BY column2 DESC LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"identifier.sql",language:"sql"},{offset:14,type:"delimiter.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"},{offset:16,type:"keyword.sql",language:"sql"},{offset:20,type:"white.sql",language:"sql"},{offset:21,type:"identifier.sql",language:"sql"},{offset:27,type:"white.sql",language:"sql"},{offset:28,type:"keyword.sql",language:"sql"},{offset:33,type:"white.sql",language:"sql"},{offset:34,type:"identifier.sql",language:"sql"},{offset:41,type:"white.sql",language:"sql"},{offset:42,type:"operator.sql",language:"sql"},{offset:43,type:"white.sql",language:"sql"},{offset:44,type:"identifier.quote.sql",language:"sql"},{offset:45,type:"identifier.sql",language:"sql"},{offset:51,type:"identifier.quote.sql",language:"sql"},{offset:52,type:"white.sql",language:"sql"},{offset:53,type:"keyword.sql",language:"sql"},{offset:58,type:"white.sql",language:"sql"},{offset:59,type:"keyword.sql",language:"sql"},{offset:61,type:"white.sql",language:"sql"},{offset:62,type:"identifier.sql",language:"sql"},{offset:69,type:"white.sql",language:"sql"},{offset:70,type:"keyword.sql",language:"sql"},{offset:75,type:"white.sql",language:"sql"},{offset:76,type:"keyword.sql",language:"sql"},{offset:78,type:"white.sql",language:"sql"},{offset:79,type:"identifier.sql",language:"sql"},{offset:86,type:"white.sql",language:"sql"},{offset:87,type:"keyword.sql",language:"sql"},{offset:91,type:"white.sql",language:"sql"},{offset:92,type:"keyword.sql",language:"sql"},{offset:97,type:"white.sql",language:"sql"},{offset:98,type:"number.sql",language:"sql"},{offset:100,type:"delimiter.sql",language:"sql"},{offset:101,type:"white.sql",language:"sql"},{offset:102,type:"keyword.sql",language:"sql"},{offset:108,type:"white.sql",language:"sql"},{offset:109,type:"identifier.sql",language:"sql"},{offset:116,type:"delimiter.sql",language:"sql"},{offset:117,type:"white.sql",language:"sql"},{offset:118,type:"keyword.sql",language:"sql"},{offset:122,type:"white.sql",language:"sql"},{offset:123,type:"identifier.sql",language:"sql"},{offset:129,type:"white.sql",language:"sql"},{offset:130,type:"keyword.sql",language:"sql"},{offset:135,type:"white.sql",language:"sql"},{offset:136,type:"identifier.sql",language:"sql"},{offset:143,type:"white.sql",language:"sql"},{offset:144,type:"operator.sql",language:"sql"},{offset:145,type:"white.sql",language:"sql"},{offset:146,type:"identifier.quote.sql",language:"sql"},{offset:147,type:"identifier.sql",language:"sql"},{offset:153,type:"identifier.quote.sql",language:"sql"},{offset:154,type:"white.sql",language:"sql"},{offset:155,type:"keyword.sql",language:"sql"},{offset:160,type:"white.sql",language:"sql"},{offset:161,type:"keyword.sql",language:"sql"},{offset:163,type:"white.sql",language:"sql"},{offset:164,type:"identifier.sql",language:"sql"},{offset:171,type:"white.sql",language:"sql"},{offset:172,type:"keyword.sql",language:"sql"},{offset:177,type:"white.sql",language:"sql"},{offset:178,type:"keyword.sql",language:"sql"},{offset:180,type:"white.sql",language:"sql"},{offset:181,type:"identifier.sql",language:"sql"},{offset:188,type:"white.sql",language:"sql"},{offset:189,type:"keyword.sql",language:"sql"},{offset:193,type:"white.sql",language:"sql"},{offset:194,type:"keyword.sql",language:"sql"},{offset:199,type:"white.sql",language:"sql"},{offset:200,type:"number.sql",language:"sql"},{offset:202,type:"delimiter.sql",language:"sql"}]]},singleLineTwoQueriesWithAggregation:{query:'SELECT count(column1), FROM table1 WHERE column1 = "value1" GROUP BY column1 ORDER BY column1 DESC LIMIT 10; SELECT count(column2), FROM table2 WHERE column2 = "value2" GROUP BY column1 ORDER BY column2 DESC LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"predefined.sql",language:"sql"},{offset:12,type:"delimiter.parenthesis.sql",language:"sql"},{offset:13,type:"identifier.sql",language:"sql"},{offset:20,type:"delimiter.parenthesis.sql",language:"sql"},{offset:21,type:"delimiter.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"keyword.sql",language:"sql"},{offset:27,type:"white.sql",language:"sql"},{offset:28,type:"identifier.sql",language:"sql"},{offset:34,type:"white.sql",language:"sql"},{offset:35,type:"keyword.sql",language:"sql"},{offset:40,type:"white.sql",language:"sql"},{offset:41,type:"identifier.sql",language:"sql"},{offset:48,type:"white.sql",language:"sql"},{offset:49,type:"operator.sql",language:"sql"},{offset:50,type:"white.sql",language:"sql"},{offset:51,type:"identifier.quote.sql",language:"sql"},{offset:52,type:"identifier.sql",language:"sql"},{offset:58,type:"identifier.quote.sql",language:"sql"},{offset:59,type:"white.sql",language:"sql"},{offset:60,type:"keyword.sql",language:"sql"},{offset:65,type:"white.sql",language:"sql"},{offset:66,type:"keyword.sql",language:"sql"},{offset:68,type:"white.sql",language:"sql"},{offset:69,type:"identifier.sql",language:"sql"},{offset:76,type:"white.sql",language:"sql"},{offset:77,type:"keyword.sql",language:"sql"},{offset:82,type:"white.sql",language:"sql"},{offset:83,type:"keyword.sql",language:"sql"},{offset:85,type:"white.sql",language:"sql"},{offset:86,type:"identifier.sql",language:"sql"},{offset:93,type:"white.sql",language:"sql"},{offset:94,type:"keyword.sql",language:"sql"},{offset:98,type:"white.sql",language:"sql"},{offset:99,type:"keyword.sql",language:"sql"},{offset:104,type:"white.sql",language:"sql"},{offset:105,type:"number.sql",language:"sql"},{offset:107,type:"delimiter.sql",language:"sql"},{offset:108,type:"white.sql",language:"sql"},{offset:109,type:"keyword.sql",language:"sql"},{offset:115,type:"white.sql",language:"sql"},{offset:116,type:"predefined.sql",language:"sql"},{offset:121,type:"delimiter.parenthesis.sql",language:"sql"},{offset:122,type:"identifier.sql",language:"sql"},{offset:129,type:"delimiter.parenthesis.sql",language:"sql"},{offset:130,type:"delimiter.sql",language:"sql"},{offset:131,type:"white.sql",language:"sql"},{offset:132,type:"keyword.sql",language:"sql"},{offset:136,type:"white.sql",language:"sql"},{offset:137,type:"identifier.sql",language:"sql"},{offset:143,type:"white.sql",language:"sql"},{offset:144,type:"keyword.sql",language:"sql"},{offset:149,type:"white.sql",language:"sql"},{offset:150,type:"identifier.sql",language:"sql"},{offset:157,type:"white.sql",language:"sql"},{offset:158,type:"operator.sql",language:"sql"},{offset:159,type:"white.sql",language:"sql"},{offset:160,type:"identifier.quote.sql",language:"sql"},{offset:161,type:"identifier.sql",language:"sql"},{offset:167,type:"identifier.quote.sql",language:"sql"},{offset:168,type:"white.sql",language:"sql"},{offset:169,type:"keyword.sql",language:"sql"},{offset:174,type:"white.sql",language:"sql"},{offset:175,type:"keyword.sql",language:"sql"},{offset:177,type:"white.sql",language:"sql"},{offset:178,type:"identifier.sql",language:"sql"},{offset:185,type:"white.sql",language:"sql"},{offset:186,type:"keyword.sql",language:"sql"},{offset:191,type:"white.sql",language:"sql"},{offset:192,type:"keyword.sql",language:"sql"},{offset:194,type:"white.sql",language:"sql"},{offset:195,type:"identifier.sql",language:"sql"},{offset:202,type:"white.sql",language:"sql"},{offset:203,type:"keyword.sql",language:"sql"},{offset:207,type:"white.sql",language:"sql"},{offset:208,type:"keyword.sql",language:"sql"},{offset:213,type:"white.sql",language:"sql"},{offset:214,type:"number.sql",language:"sql"},{offset:216,type:"delimiter.sql",language:"sql"}]]},singleLineMultipleColumns:{query:'SELECT count(column1), column2 FROM table1 WHERE column1 = "value1" GROUP BY column1 ORDER BY column1, avg(column2) DESC LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"predefined.sql",language:"sql"},{offset:12,type:"delimiter.parenthesis.sql",language:"sql"},{offset:13,type:"identifier.sql",language:"sql"},{offset:20,type:"delimiter.parenthesis.sql",language:"sql"},{offset:21,type:"delimiter.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"identifier.sql",language:"sql"},{offset:30,type:"white.sql",language:"sql"},{offset:31,type:"keyword.sql",language:"sql"},{offset:35,type:"white.sql",language:"sql"},{offset:36,type:"identifier.sql",language:"sql"},{offset:42,type:"white.sql",language:"sql"},{offset:43,type:"keyword.sql",language:"sql"},{offset:48,type:"white.sql",language:"sql"},{offset:49,type:"identifier.sql",language:"sql"},{offset:56,type:"white.sql",language:"sql"},{offset:57,type:"operator.sql",language:"sql"},{offset:58,type:"white.sql",language:"sql"},{offset:59,type:"identifier.quote.sql",language:"sql"},{offset:60,type:"identifier.sql",language:"sql"},{offset:66,type:"identifier.quote.sql",language:"sql"},{offset:67,type:"white.sql",language:"sql"},{offset:68,type:"keyword.sql",language:"sql"},{offset:73,type:"white.sql",language:"sql"},{offset:74,type:"keyword.sql",language:"sql"},{offset:76,type:"white.sql",language:"sql"},{offset:77,type:"identifier.sql",language:"sql"},{offset:84,type:"white.sql",language:"sql"},{offset:85,type:"keyword.sql",language:"sql"},{offset:90,type:"white.sql",language:"sql"},{offset:91,type:"keyword.sql",language:"sql"},{offset:93,type:"white.sql",language:"sql"},{offset:94,type:"identifier.sql",language:"sql"},{offset:101,type:"delimiter.sql",language:"sql"},{offset:102,type:"white.sql",language:"sql"},{offset:103,type:"predefined.sql",language:"sql"},{offset:106,type:"delimiter.parenthesis.sql",language:"sql"},{offset:107,type:"identifier.sql",language:"sql"},{offset:114,type:"delimiter.parenthesis.sql",language:"sql"},{offset:115,type:"white.sql",language:"sql"},{offset:116,type:"keyword.sql",language:"sql"},{offset:120,type:"white.sql",language:"sql"},{offset:121,type:"keyword.sql",language:"sql"},{offset:126,type:"white.sql",language:"sql"},{offset:127,type:"number.sql",language:"sql"},{offset:129,type:"delimiter.sql",language:"sql"}]]},multiLineMultipleColumns:{query:'SELECT count(column1), column2 \n  FROM table1 \n  \n  WHERE column1 = "value1" \n  GROUP BY column1 ORDER BY column1, avg(column2) DESC \n  LIMIT 10;',tokens:[[{offset:0,type:"keyword.sql",language:"sql"},{offset:6,type:"white.sql",language:"sql"},{offset:7,type:"predefined.sql",language:"sql"},{offset:12,type:"delimiter.parenthesis.sql",language:"sql"},{offset:13,type:"identifier.sql",language:"sql"},{offset:20,type:"delimiter.parenthesis.sql",language:"sql"},{offset:21,type:"delimiter.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"identifier.sql",language:"sql"},{offset:30,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:4,type:"white.sql",language:"sql"},{offset:5,type:"identifier.sql",language:"sql"},{offset:11,type:"white.sql",language:"sql"}],[{offset:0,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"identifier.sql",language:"sql"},{offset:13,type:"white.sql",language:"sql"},{offset:14,type:"operator.sql",language:"sql"},{offset:15,type:"white.sql",language:"sql"},{offset:16,type:"identifier.quote.sql",language:"sql"},{offset:17,type:"identifier.sql",language:"sql"},{offset:23,type:"identifier.quote.sql",language:"sql"},{offset:24,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"keyword.sql",language:"sql"},{offset:8,type:"white.sql",language:"sql"},{offset:9,type:"identifier.sql",language:"sql"},{offset:16,type:"white.sql",language:"sql"},{offset:17,type:"keyword.sql",language:"sql"},{offset:22,type:"white.sql",language:"sql"},{offset:23,type:"keyword.sql",language:"sql"},{offset:25,type:"white.sql",language:"sql"},{offset:26,type:"identifier.sql",language:"sql"},{offset:33,type:"delimiter.sql",language:"sql"},{offset:34,type:"white.sql",language:"sql"},{offset:35,type:"predefined.sql",language:"sql"},{offset:38,type:"delimiter.parenthesis.sql",language:"sql"},{offset:39,type:"identifier.sql",language:"sql"},{offset:46,type:"delimiter.parenthesis.sql",language:"sql"},{offset:47,type:"white.sql",language:"sql"},{offset:48,type:"keyword.sql",language:"sql"},{offset:52,type:"white.sql",language:"sql"}],[{offset:0,type:"keyword.sql",language:"sql"},{offset:5,type:"white.sql",language:"sql"},{offset:6,type:"number.sql",language:"sql"},{offset:8,type:"delimiter.sql",language:"sql"}]]}});var _,D,L=function(e){var t=e.children,n=h(e,["children"]),r=d.useStyles2(g.useCallback((function(e){return k(e,n)}),[n]));return y.createElement("div",{className:r.root},t)},k=function(e,t){var n,r,l;return{root:m.css({display:"flex",flexDirection:null!==(n=t.direction)&&void 0!==n?n:"row",flexWrap:null===(r=t.wrap)||void 0===r||r?"wrap":void 0,alignItems:t.alignItems,gap:e.spacing(null!==(l=t.gap)&&void 0!==l?l:2),flexGrow:t.flexGrow})}},F=(y.forwardRef((function(e,t){var n=e.items,r=e.renderItem,l=e.onChange;return y.createElement(L,null,n.map((function(e,t){return y.createElement("div",{key:t},r(e,(function(e){return function(e,t){var r=b([],E(n),!1);r[e]=t,l(r)}(t,e)}),(function(){return e=t,(r=b([],E(n),!1)).splice(e,1),void l(r);var e,r})))})),y.createElement(d.Button,{ref:t,onClick:function(){var e=b(b([],E(n),!1),[{}],!1);l(e)},variant:"secondary",size:"md",icon:"plus","aria-label":"Add",type:"button"}))})),function(e){var t=e.children,n=e.title,r=e.description,l=e.isCollapsible,i=void 0!==l&&l,a=e.isInitiallyOpen,o=void 0===a||a,s=e.kind,u=void 0===s?"section":s,c=e.className,f=d.useTheme2(),p=f.colors,h=f.typography,b=f.spacing,q=E(g.useState(!i||o),2),O=q[0],w=q[1],S=O?"angle-up":"angle-down",T="sub-section"===u,A="".concat(O?"Collapse":"Expand"," section ").concat(n),I={header:m.css({display:"flex",justifyContent:"space-between",alignItems:"center"}),title:m.css({margin:0}),subtitle:m.css({margin:0,fontWeight:h.fontWeightRegular}),descriptionText:m.css(v(v({marginTop:b(T?.25:.5),marginBottom:0},h.bodySmall),{color:p.text.secondary})),content:m.css({marginTop:b(2)})};return y.createElement("div",{className:c},y.createElement("div",{className:I.header},"section"===u?y.createElement("h3",{className:I.title},n):y.createElement("h6",{className:I.subtitle},n),i&&y.createElement(d.IconButton,{name:S,onClick:function(){return w(!O)},type:"button",size:"xl","aria-label":A})),r&&y.createElement("p",{className:I.descriptionText},r),O&&y.createElement("div",{className:I.content},t))}),M=function(e){var t=e.children,n=h(e,["children"]);return y.createElement(F,v({},n,{kind:"sub-section"}),t)};(_=t.Hi||(t.Hi={})).NoAuth="NoAuth",_.BasicAuth="BasicAuth",_.OAuthForward="OAuthForward",_.CrossSiteCredentials="CrossSiteCredentials";(D={})[t.Hi.BasicAuth]={label:"Basic authentication",value:t.Hi.BasicAuth,description:"Authenticate with your data source username and password"},D[t.Hi.CrossSiteCredentials]={label:"Enable cross-site access control requests",value:t.Hi.CrossSiteCredentials,description:"Allow cross-site Access-Control requests with your existing credentials and cookies. This enables the server to authenticate the user and perform authorized requests on their behalf on other domains."},D[t.Hi.OAuthForward]={label:"Forward OAuth Identity",value:t.Hi.OAuthForward,description:"Forward the OAuth access token (and if available: the OIDC ID token) of the user querying to the data source"},D[t.Hi.NoAuth]={label:"No Authentication",value:t.Hi.NoAuth,description:"Data source is available without authentication"};t.ConfigSubSection=M},988:(e,t,n)=>{"use strict";e.exports=n(853)},644:e=>{"use strict";e.exports=a},305:t=>{"use strict";t.exports=e},545:e=>{"use strict";e.exports=r},388:e=>{"use strict";e.exports=l},980:e=>{"use strict";e.exports=t},650:e=>{"use strict";e.exports=i},129:e=>{"use strict";e.exports=o},177:e=>{"use strict";e.exports=n}},u={};function c(e){var t=u[e];if(void 0!==t)return t.exports;var n=u[e]={exports:{}};return s[e](n,n.exports,c),n.exports}c.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return c.d(t,{a:t}),t},c.d=(e,t)=>{for(var n in t)c.o(t,n)&&!c.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var f={};return(()=>{"use strict";c.r(f),c.d(f,{plugin:()=>Vl});var e=c(305),t=c(980),n=c(177);function r(e){return"function"==typeof e}function l(e){return function(t){if(function(e){return r(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)};function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function o(e,t){var n,r,l,i,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(a=0)),a;)try{if(n=1,r&&(l=2&o[0]?r.return:o[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,o[1])).done)return l;switch(r=0,l&&(o=[2&o[0],l.value]),o[0]){case 0:case 1:l=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((l=(l=a.trys).length>0&&l[l.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!l||o[1]>l[0]&&o[1]<l[3])){a.label=o[1];break}if(6===o[0]&&a.label<l[1]){a.label=l[1],l=o;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(o);break}l[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=l=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function s(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,l,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){l={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(l)throw l.error}}return a}function p(e,t,n){if(n||2===arguments.length)for(var r,l=0,i=t.length;l<i;l++)!r&&l in t||(r||(r=Array.prototype.slice.call(t,0,l)),r[l]=t[l]);return e.concat(r||Array.prototype.slice.call(t))}function d(e){return this instanceof d?(this.v=e,this):new d(e)}Object.create,Object.create;var g,y,m=(g=function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}},(y=g((function(e){Error.call(e),e.stack=(new Error).stack}))).prototype=Object.create(Error.prototype),y.prototype.constructor=y,y);function v(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var h=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,l,i;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var o=s(a),c=o.next();!c.done;c=o.next())c.value.remove(this)}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else a.remove(this);var f=this.initialTeardown;if(r(f))try{f()}catch(e){i=e instanceof m?e.errors:[e]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var g=s(d),y=g.next();!y.done;y=g.next()){var v=y.value;try{b(v)}catch(e){i=null!=i?i:[],e instanceof m?i=p(p([],u(i)),u(e.errors)):i.push(e)}}}catch(e){n={error:e}}finally{try{y&&!y.done&&(l=g.return)&&l.call(g)}finally{if(n)throw n.error}}}if(i)throw new m(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)b(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&v(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&v(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();function E(e){return e instanceof h||e&&"closed"in e&&r(e.remove)&&r(e.add)&&r(e.unsubscribe)}function b(e){r(e)?e():e.unsubscribe()}h.EMPTY;var q={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},O={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var l=O.delegate;return(null==l?void 0:l.setTimeout)?l.setTimeout.apply(l,p([e,t],u(n))):setTimeout.apply(void 0,p([e,t],u(n)))},clearTimeout:function(e){var t=O.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function w(e){O.setTimeout((function(){var t=q.onUnhandledError;if(!t)throw e;t(e)}))}function S(){}var T=A("C",void 0,void 0);function A(e,t,n){return{kind:e,value:t,error:n}}var I=null,R=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,E(t)&&t.add(n)):n.destination=k,n}return a(t,e),t.create=function(e,t,n){return new _(e,t,n)},t.prototype.next=function(e){this.isStopped?L(function(e){return A("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?L(A("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?L(T,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(h),P=Function.prototype.bind;function N(e,t){return P.call(e,t)}var C=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){D(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){D(e)}else D(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){D(e)}},e}(),_=function(e){function t(t,n,l){var i,a,o=e.call(this)||this;return r(t)||!t?i={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=l?l:void 0}:o&&q.useDeprecatedNextContext?((a=Object.create(t)).unsubscribe=function(){return o.unsubscribe()},i={next:t.next&&N(t.next,a),error:t.error&&N(t.error,a),complete:t.complete&&N(t.complete,a)}):i=t,o.destination=new C(i),o}return a(t,e),t}(R);function D(e){var t;q.useDeprecatedSynchronousErrorHandling?(t=e,q.useDeprecatedSynchronousErrorHandling&&I&&(I.errorThrown=!0,I.error=t)):w(e)}function L(e,t){var n=q.onStoppedNotification;n&&O.setTimeout((function(){return n(e,t)}))}var k={closed:!0,next:S,error:function(e){throw e},complete:S};function F(e,t,n,r,l){return new M(e,t,n,r,l)}var M=function(e){function t(t,n,r,l,i,a){var o=e.call(this,t)||this;return o.onFinalize=i,o.shouldUnsubscribe=a,o._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,o._error=l?function(e){try{l(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,o._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,o}return a(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(R);function j(e,t){return l((function(n,r){var l=0;n.subscribe(F(r,(function(n){r.next(e.call(t,n,l++))})))}))}var x=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e},U="function"==typeof Symbol&&Symbol.observable||"@@observable";function B(e){return e}var V=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var l,i=this,a=(l=e)&&l instanceof R||function(e){return e&&r(e.next)&&r(e.error)&&r(e.complete)}(l)&&E(l)?e:new _(e,t,n);return function(e){if(q.useDeprecatedSynchronousErrorHandling){var t=!I;if(t&&(I={errorThrown:!1,error:null}),e(),t){var n=I,r=n.errorThrown,l=n.error;if(I=null,r)throw l}}else e()}((function(){var e=i,t=e.operator,n=e.source;a.add(t?t.call(a,n):n?i._subscribe(a):i._trySubscribe(a))})),a},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=Y(t))((function(t,r){var l=new _({next:function(t){try{e(t)}catch(e){r(e),l.unsubscribe()}},error:r,complete:t});n.subscribe(l)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[U]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0===(n=e).length?B:1===n.length?n[0]:function(e){return n.reduce((function(e,t){return t(e)}),e)})(this);var n},e.prototype.toPromise=function(e){var t=this;return new(e=Y(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function Y(e){var t;return null!==(t=null!=e?e:q.Promise)&&void 0!==t?t:Promise}var G="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function W(e){if(e instanceof V)return e;if(null!=e){if(function(e){return r(e[U])}(e))return i=e,new V((function(e){var t=i[U]();if(r(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(x(e))return l=e,new V((function(e){for(var t=0;t<l.length&&!e.closed;t++)e.next(l[t]);e.complete()}));if(r(null==(n=e)?void 0:n.then))return function(e){return new V((function(t){e.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,w)}))}(e);if(function(e){return Symbol.asyncIterator&&r(null==e?void 0:e[Symbol.asyncIterator])}(e))return H(e);if(function(e){return r(null==e?void 0:e[G])}(e))return t=e,new V((function(e){var n,r;try{for(var l=s(t),i=l.next();!i.done;i=l.next()){var a=i.value;if(e.next(a),e.closed)return}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}e.complete()}));if(function(e){return r(null==e?void 0:e.getReader)}(e))return H(function(e){return function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,l=n.apply(e,t||[]),i=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){l[e]&&(r[e]=function(t){return new Promise((function(n,r){i.push([e,t,n,r])>1||o(e,t)}))})}function o(e,t){try{!function(e){e.value instanceof d?Promise.resolve(e.value.v).then(s,u):c(i[0][2],e)}(l[e](t))}catch(e){c(i[0][3],e)}}function s(e){o("next",e)}function u(e){o("throw",e)}function c(e,t){e(t),i.shift(),i.length&&o(i[0][0],i[0][1])}}(this,arguments,(function(){var t,n,r;return o(this,(function(l){switch(l.label){case 0:t=e.getReader(),l.label=1;case 1:l.trys.push([1,,9,10]),l.label=2;case 2:return[4,d(t.read())];case 3:return n=l.sent(),r=n.value,n.done?[4,d(void 0)]:[3,5];case 4:return[2,l.sent()];case 5:return[4,d(r)];case 6:return[4,l.sent()];case 7:return l.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}(e))}var t,n,l,i;throw function(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}(e)}function H(e){return new V((function(t){(function(e,t){var n,r,l,i;return function(e,t,n,r){return new(n||(n=Promise))((function(l,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function o(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}s((r=r.apply(e,t||[])).next())}))}(this,void 0,void 0,(function(){var a,u;return o(this,(function(o){switch(o.label){case 0:o.trys.push([0,5,6,11]),n=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=s(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,l){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,l,(t=e[n](t)).done,t.value)}))}}}(e),o.label=1;case 1:return[4,n.next()];case 2:if((r=o.sent()).done)return[3,4];if(a=r.value,t.next(a),t.closed)return[2];o.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return u=o.sent(),l={error:u},[3,11];case 6:return o.trys.push([6,,9,10]),r&&!r.done&&(i=n.return)?[4,i.call(n)]:[3,8];case 7:o.sent(),o.label=8;case 8:return[3,10];case 9:if(l)throw l.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function $(e,t,n){return void 0===n&&(n=1/0),r(t)?$((function(n,r){return j((function(e,l){return t(n,e,r,l)}))(W(e(n,r)))}),n):("number"==typeof t&&(n=t),l((function(t,r){return function(e,t,n,r,l,i,a,o){var s=[],u=0,c=0,f=!1,p=function(){!f||s.length||u||t.complete()},d=function(e){return u<r?g(e):s.push(e)},g=function(e){u++;var l=!1;W(n(e,c++)).subscribe(F(t,(function(e){t.next(e)}),(function(){l=!0}),void 0,(function(){if(l)try{u--;for(var e=function(){var e=s.shift();g(e)};s.length&&u<r;)e();p()}catch(e){t.error(e)}})))};return e.subscribe(F(t,d,(function(){f=!0,p()}))),function(){}}(t,r,e,n)})))}function K(e){return l((function(t,n){var r,l=null,i=!1;l=t.subscribe(F(n,void 0,void 0,(function(a){r=W(e(a,K(e)(t))),l?(l.unsubscribe(),l=null,r.subscribe(n)):i=!0}))),i&&(l.unsubscribe(),l=null,r.subscribe(n))}))}var Q,X=c(545);!function(e){e.Backward="BACKWARD",e.Forward="FORWARD"}(Q||(Q={}));class z{getRangeFilter(){const e={};return e[this.timeField]={gte:"$timeFrom",lte:"$timeTo"},e}getTermsQuery(e){const t={size:0,query:{bool:{filter:[{range:this.getRangeFilter()}]}}};e.query&&t.query.bool.filter.push({query_string:{query:e.query}});let n=500;e.size&&(n=e.size),t.aggs={1:{terms:{field:e.field,size:n,order:{}}}};const{orderBy:r="key",order:l=("doc_count"===r?"desc":"asc")}=e;if(["asc","desc"].indexOf(l)<0)throw{message:`Invalid query sort order ${l}`};switch(r){case"key":case"term":const e="_key";t.aggs[1].terms.order[e]=l;break;case"doc_count":t.aggs[1].terms.order._count=l;break;default:throw{message:`Invalid query sort type ${r}`}}return t}constructor(e){var t,n;n=void 0,(t="timeField")in this?Object.defineProperty(this,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[t]=n,this.timeField=e.timeField}}var J=c(388),Z=(e=>(e.Bars="bars",e.Line="line",e.Points="points",e))(Z||{}),ee=(e=>(e.None="none",e.Normal="normal",e.Percent="percent",e))(ee||{}),te=(e=>(e[e.After=1]="After",e[e.Before=-1]="Before",e[e.Center=0]="Center",e))(te||{});const ne=e=>({name:e,pipelineAgg:""}),re=e=>`var${Math.max(0,...e.map((e=>{var t;return parseInt((null===(t=e.name.match("^var(\\d+)$"))||void 0===t?void 0:t[1])||"0",10)})))+1}`,le=e=>{var t;return"ewma"===(null===(t=e.settings)||void 0===t?void 0:t.model)},ie=e=>{var t;return"holt"===(null===(t=e.settings)||void 0===t?void 0:t.model)},ae=e=>{var t;return"holt_winters"===(null===(t=e.settings)||void 0===t?void 0:t.model)},oe=e=>pe[e.type].requiresField,se=e=>pe[e.type].isPipelineAgg,ue=e=>pe[e.type].supportsMultipleBucketPaths,ce=e=>pe[e.type].hasSettings,fe=["count","avg","sum","min","max","extended_stats","percentiles","cardinality","raw_document","raw_data","logs","moving_avg","moving_fn","derivative","serial_diff","cumulative_sum","bucket_script","rate","top_metrics"],pe={count:{label:"Count",impliedQueryType:"metrics",requiresField:!1,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!1,hasMeta:!1,supportsInlineScript:!1,defaults:{}},avg:{label:"Average",impliedQueryType:"metrics",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{}},sum:{label:"Sum",impliedQueryType:"metrics",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{}},max:{label:"Max",impliedQueryType:"metrics",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{}},min:{label:"Min",impliedQueryType:"metrics",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{}},extended_stats:{label:"Extended Stats",impliedQueryType:"metrics",requiresField:!0,supportsMissing:!0,supportsInlineScript:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!0,defaults:{meta:{std_deviation_bounds_lower:!0,std_deviation_bounds_upper:!0}}},percentiles:{label:"Percentiles",impliedQueryType:"metrics",requiresField:!0,supportsMissing:!0,supportsInlineScript:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{settings:{percents:["25","50","75","95","99"]}}},cardinality:{label:"Unique Count",impliedQueryType:"metrics",requiresField:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{}},moving_avg:{label:"Moving Average",impliedQueryType:"metrics",requiresField:!0,isPipelineAgg:!0,versionRange:"<8.0.0",supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{settings:{model:"simple",window:"5"}}},moving_fn:{label:"Moving Function",impliedQueryType:"metrics",requiresField:!0,isPipelineAgg:!0,supportsMultipleBucketPaths:!1,supportsInlineScript:!1,supportsMissing:!1,hasMeta:!1,hasSettings:!0,defaults:{}},derivative:{label:"Derivative",impliedQueryType:"metrics",requiresField:!0,isPipelineAgg:!0,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{}},serial_diff:{label:"Serial Difference",impliedQueryType:"metrics",requiresField:!0,isPipelineAgg:!0,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{settings:{lag:"1"}}},cumulative_sum:{label:"Cumulative Sum",impliedQueryType:"metrics",requiresField:!0,isPipelineAgg:!0,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{}},bucket_script:{label:"Bucket Script",impliedQueryType:"metrics",requiresField:!1,isPipelineAgg:!0,supportsMissing:!1,supportsMultipleBucketPaths:!0,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{pipelineVariables:[ne(re([]))]}},raw_document:{label:"Raw Document (deprecated)",requiresField:!1,impliedQueryType:"raw_document",isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{settings:{size:"100"}}},raw_data:{label:"Raw Data",requiresField:!1,impliedQueryType:"raw_data",isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{settings:{size:"100"}}},logs:{label:"Logs",requiresField:!1,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,impliedQueryType:"logs",supportsInlineScript:!1,hasMeta:!1,defaults:{settings:{limit:"100"}}},top_metrics:{label:"Top Metrics",impliedQueryType:"metrics",requiresField:!1,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{settings:{order:"desc"}}},rate:{label:"Rate",impliedQueryType:"metrics",requiresField:!0,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!0,hasMeta:!1,defaults:{}}},de=(e,t)=>{const n=t.filter((t=>{var n;return ue(t)?null===(n=t.pipelineVariables)||void 0===n?void 0:n.some((t=>t.pipelineAgg===e.id)):oe(t)&&e.id===t.field}));return[...n,...n.flatMap((e=>de(e,t)))]},ge={terms:{label:"Terms",requiresField:!0,defaultSettings:{min_doc_count:"1",size:"10",order:"desc",orderBy:"_term"}},filters:{label:"Filters",requiresField:!1,defaultSettings:{filters:[{label:"",query:"*"}]}},geohash_grid:{label:"Geo Hash Grid",requiresField:!0,defaultSettings:{precision:"3"}},date_histogram:{label:"Date Histogram",requiresField:!0,defaultSettings:{interval:"auto",min_doc_count:"0",trimEdges:"0",timeZone:e.InternalTimeZones.utc}},histogram:{label:"Histogram",requiresField:!0,defaultSettings:{interval:"1000",min_doc_count:"0"}},nested:{label:"Nested (experimental)",requiresField:!0,defaultSettings:{}}},ye=[{label:"Term value",value:"_term"},{label:"Doc Count",value:"_count"}],me=[{label:"Top",value:"desc"},{label:"Bottom",value:"asc"}],ve=[{label:"No limit",value:"0"},{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"},{label:"5",value:"5"},{label:"10",value:"10"},{label:"15",value:"15"},{label:"20",value:"20"}],he=e=>ge[e.type].requiresField,Ee=["date_histogram","histogram","terms","filters","geohash_grid","nested"];class be extends e.LanguageProvider{importFromAbstractQuery(e){return{metrics:[{id:"1",type:"logs"}],query:this.getElasticsearchQuery(e.labelMatchers),refId:e.refId}}getElasticsearchQuery(t){return t.map((t=>{switch(t.operator){case e.AbstractLabelOperator.Equal:return t.name+':"'+t.value+'"';case e.AbstractLabelOperator.NotEqual:return"-"+t.name+':"'+t.value+'"';case e.AbstractLabelOperator.EqualRegEx:return t.name+":/"+t.value+"/";case e.AbstractLabelOperator.NotEqualRegEx:return"-"+t.name+":/"+t.value+"/"}})).join(" AND ")}constructor(e,t){var n,r;super(),r=void 0,(n="datasource")in this?Object.defineProperty(this,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[n]=r,this.datasource=e,Object.assign(this,t)}}function qe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){qe(e,t,n[t])}))}return e}function we(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const Se=e=>oe(e)?`${pe[e.type].label} ${e.field}`:pe[e.type].label,Te=e=>{const t=e.match(/{.*}/);if(!t)return null;try{return JSON.parse(t[0])}catch(e){return null}},Ae=e=>Object.entries(e).reduce(((e,[t,n])=>{if(null==n)return Oe({},e);if(Array.isArray(n)&&0===n.length)return Oe({},e);if("string"==typeof n&&0===n.length)return Oe({},e);if(!Array.isArray(n)&&"object"==typeof n){const r=Ae(n);return 0===Object.keys(r).length?Oe({},e):we(Oe({},e),{[t]:r})}return we(Oe({},e),{[t]:n})}),{}),Ie={date:"date",date_nanos:"date",keyword:"string",text:"string",binary:"string",byte:"number",long:"number",unsigned_long:"number",double:"number",integer:"number",short:"number",float:"number",scaled_float:"number"};function Re(e,t,n,r,l,i,a){try{var o=e[i](a),s=o.value}catch(e){return void n(e)}o.done?t(s):Promise.resolve(s).then(r,l)}function Pe(e){return function(){var t=this,n=arguments;return new Promise((function(r,l){var i=e.apply(t,n);function a(e){Re(i,r,l,a,o,"next",e)}function o(e){Re(i,r,l,a,o,"throw",e)}a(void 0)}))}}function Ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ne(e,t,n[t])}))}return e}function _e(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}class De extends X.DataSourceWithBackend{query(e){return super.query(e).pipe(j((e=>(e.data.forEach((e=>{!function(e,t){if(t.length)for(const n of e.fields){const e=t.filter((e=>e.field===n.name));0!==e.length&&(n.config=n.config||{},n.config.links=[...(n.config.links,e.map(Ge))])}}(e,this.dataLinks)})),e))))}testDatasource(){var e=this;return Pe((function*(){return""===e.index?{status:"error",message:"Cannot save datasource, `index` is required"}:(0,n.lastValueFrom)((0,n.from)(e.getResource("indexes/"+e.index)).pipe($((t=>{let r=e.validateIndexConfig(t);return r?(0,n.of)({status:"error",message:r}):(0,n.of)({status:"success",message:"Index OK. Time field name OK"})})),K((e=>{if(e.data&&e.data.error){let t=Te(e.data.error);t&&(e=t)}return e.status&&404===e.status?(0,n.of)({status:"error",message:"Index does not exists."}):e.message?(0,n.of)({status:"error",message:e.message}):(0,n.of)({status:"error",message:e.status})}))))}))()}validateIndexConfig(e){if(""===this.timeField)return"Time field must not be empty";let t=Le(e.index_config.doc_mapping.field_mappings).find((e=>e.json_path===this.timeField));if(void 0===t)return`No field named '${this.timeField}' found in the doc mapping. This should never happen.`;let n=t.field_mapping.output_format||"unknown";return["unix_timestamp_secs","unix_timestamp_millis","unix_timestamp_micros","unix_timestamp_nanos","iso8601","rfc3339"].includes(n)?void 0:`Timestamp output format '${n} is not yet supported.`}importFromAbstractQueries(e){var t=this;return Pe((function*(){return e.map((e=>t.languageProvider.importFromAbstractQuery(e)))}))()}getDataProvider(t,n){if(this.getSupportedSupplementaryQueryTypes().includes(t))return t===e.SupplementaryQueryType.LogsVolume?this.getLogsVolumeDataProvider(n):void 0}getSupportedSupplementaryQueryTypes(){return[e.SupplementaryQueryType.LogsVolume]}getSupplementaryQuery(t,n){if(!this.getSupportedSupplementaryQueryTypes().includes(t.type))return;let r=!1;if(t.type===e.SupplementaryQueryType.LogsVolume){var l;if(r=!(1!==(null===(l=n.metrics)||void 0===l?void 0:l.length)||"logs"!==n.metrics[0].type),!r)return;const e=[];var i;const t=null!==(i=this.timeField)&&void 0!==i?i:"timestamp";return this.logLevelField&&e.push({id:"2",type:"terms",settings:{min_doc_count:"0",size:"0",order:"desc",orderBy:"_count"},field:this.logLevelField}),e.push({id:"3",type:"date_histogram",settings:{interval:"auto",min_doc_count:"0",trimEdges:"0"},field:t}),{refId:`log-volume-${n.refId}`,query:n.query,metrics:[{type:"count",id:"1"}],timeField:t,bucketAggs:e}}}getLogsVolumeDataProvider(r){const l=(0,t.cloneDeep)(r),i=l.targets.map((t=>this.getSupplementaryQuery({type:e.SupplementaryQueryType.LogsVolume},t))).filter((e=>!!e));if(i.length)return function(r,l,i){const a=i.range.to.valueOf()-i.range.from.valueOf(),o=function(e,t){if(e.__interval_ms){let n=e.__interval_ms.value,r="";return t<5*je?(n=Me,r="1ms"):n>Ue?(n=Be,r="1d"):n>xe?(n=Ue,r="1h"):n>je?(n=xe,r="1m"):(n=je,r="1s"),{interval:r,intervalMs:n}}return{interval:"$__interval"}}(l.scopedVars,a);return l.interval=o.interval,l.scopedVars.__interval={value:o.interval,text:o.interval},void 0!==o.intervalMs&&(l.intervalMs=o.intervalMs,l.scopedVars.__interval_ms={value:o.intervalMs,text:o.intervalMs}),l.hideFromInspector=!0,new n.Observable((a=>{let o=[];a.next({state:e.LoadingState.Loading,error:void 0,data:[]});const s=r.query(l),u=((0,n.isObservable)(s)?s:(0,n.from)(s)).subscribe({complete:()=>{a.complete()},next:n=>{const{error:l}=n;if(void 0!==l)a.next({state:e.LoadingState.Error,error:l,data:[]}),a.error(l);else{const l=(0,t.groupBy)(n.data,"refId");o=n.data.map((t=>{var n;let a=t.refId||"";a.startsWith("log-volume-")&&(a=a.substr(11));const o={logsVolumeType:e.LogsVolumeType.FullRange,absoluteRange:{from:i.range.from.valueOf(),to:i.range.to.valueOf()},datasourceName:r.name,sourceQuery:i.targets.find((e=>e.refId===a))};return t.meta=_e(Ce({},t.meta),{custom:Ce({},null===(n=t.meta)||void 0===n?void 0:n.custom,o)}),ke(t,i.extractLevel,1===l[t.refId].length)})),a.next({state:n.state,error:void 0,data:o})}},error:t=>{a.next({state:e.LoadingState.Error,error:t,data:[]}),a.error(t)}});return()=>{var e;null===(e=u)||void 0===e||e.unsubscribe()}}))}(this,_e(Ce({},l),{targets:i}),{range:r.range,targets:r.targets,extractLevel:t=>function(t){const n=t.fields[1].config.displayNameFromDS||"",r=e.LogLevel[n.toString().toLowerCase()];return r||e.LogLevel.unknown}(t||"")})}modifyQuery(e,t){if(!t.options)return e;var n;let r=null!==(n=e.query)&&void 0!==n?n:"";switch(t.type){case"ADD_FILTER":r.length>0&&(r+=" AND "),r+=`${t.options.key}:"${t.options.value}"`;break;case"ADD_FILTER_OUT":r.length>0&&(r+=" AND "),r+=`-${t.options.key}:"${t.options.value}"`}return _e(Ce({},e),{query:r})}getTerms(r,l=(0,e.getDefaultTimeRange)()){const i=JSON.stringify({ignore_unavailable:!0,index:this.index});let a=JSON.stringify(this.queryBuilder.getTermsQuery(r));return a=a.replace(/\$timeFrom/g,l.from.valueOf().toString()),a=a.replace(/\$timeTo/g,l.to.valueOf().toString()),a=i+"\n"+a+"\n",(0,n.from)(this.postResource("_elastic/_msearch",a,{headers:{"content-type":"application/x-ndjson"}})).pipe(j((e=>{if(!e.responses[0].aggregations)return[];const n=e.responses[0].aggregations[1].buckets;return(0,t.map)(n,(e=>({text:e.key_as_string||e.key,value:e.key})))})))}getFields(e,t,r){return(0,n.from)(this.getResource("_elastic/"+this.index+"/_field_caps")).pipe(j((n=>Object.entries(n.fields).flatMap((([e,t])=>Object.values(t).map((t=>(t.field_name=e,t))))).filter((n=>{var r,l,i;return(void 0===e||n.aggregatable===e)&&(0===(null===(r=t)||void 0===r?void 0:r.length)||(null===(l=t)||void 0===l?void 0:l.includes(n.type))||(null===(i=t)||void 0===i?void 0:i.includes(Ie[n.type])))})).map((e=>({text:e.field_name,value:Ie[e.type]}))))))}getTagKeys(){return(0,n.lastValueFrom)(this.getFields(!0))}getTagValues(t){const r=(0,e.getDefaultTimeRange)();return(0,n.lastValueFrom)(this.getTerms({field:t.key},r))}getQueryDisplayText(e){var t,n;const r=e.metrics,l=e.bucketAggs;let i="";return e.query&&(i+="Query: "+e.query+", "),i+="Metrics: ",i+=null===(t=r)||void 0===t?void 0:t.reduce(((e,t)=>{let n=pe[t.type].label+"(";return oe(t)&&(n+=t.field),n+="), ",`${e} ${n}`}),""),i+=null===(n=l)||void 0===n?void 0:n.reduce(((e,t,n)=>{let r="";return 0===n&&(r+=" Group by: "),r+=ge[t.type].label+"(",he(t)&&(r+=t.field),`${e} ${r}), `}),""),e.alias&&(i+="Alias: "+e.alias),i}showContextToggle(e){return!0}getLogRowContextUi(e,t){return!0}filterQuery(e){return!e.hide}metricFindQuery(e,t){var r;const l=null===(r=t)||void 0===r?void 0:r.range,i=JSON.parse(e);if(e){if("fields"===i.find)return i.type=this.interpolateLuceneQuery(i.type),(0,n.lastValueFrom)(this.getFields(!0,i.type,l));if("terms"===i.find)return i.field=this.interpolateLuceneQuery(i.field),i.query=this.interpolateLuceneQuery(i.query),(0,n.lastValueFrom)(this.getTerms(i,l))}return Promise.resolve([])}interpolateLuceneQuery(e,t){return this.templateSrv.replace(e,t,Ve)}interpolateVariablesInQueries(e,t){return e.map((e=>this.applyTemplateVariables(e,t)))}applyTemplateVariables(e,t){var n;const r=_e(Ce({},e),{datasource:this.getRef(),query:this.interpolateLuceneQuery(e.query||"",t),bucketAggs:null===(n=e.bucketAggs)||void 0===n?void 0:n.map((e=>{var n,r;return"filters"===e.type?_e(Ce({},e),{settings:_e(Ce({},e.settings),{filters:null===(r=e.settings)||void 0===r||null===(n=r.filters)||void 0===n?void 0:n.map((e=>_e(Ce({},e),{query:this.interpolateLuceneQuery(e.query,t)||"*"})))})}):e}))});return JSON.parse(this.templateSrv.replace(JSON.stringify(r),t))}constructor(t,r=(0,X.getTemplateSrv)()){super(t),Ne(this,"templateSrv",void 0),Ne(this,"index",void 0),Ne(this,"timeField",void 0),Ne(this,"timeOutputFormat",void 0),Ne(this,"logMessageField",void 0),Ne(this,"logLevelField",void 0),Ne(this,"queryBuilder",void 0),Ne(this,"dataLinks",void 0),Ne(this,"languageProvider",void 0),Ne(this,"makeLogContextDataRequest",void 0),Ne(this,"getLogRowContext",void 0),this.templateSrv=r,this.makeLogContextDataRequest=(t,n)=>{var r,l,i,a,o;const s=(null===(r=n)||void 0===r?void 0:r.direction)||Q.Backward;var u;const c=null!==(u=null===(l=t.dataFrame.fields.find((e=>"sort"===e.name)))||void 0===l?void 0:l.values.get(t.rowIndex))&&void 0!==u?u:[t.timeEpochNs],f={type:"logs",id:"1",settings:{limit:(null===(i=n)||void 0===i?void 0:i.limit)?null===(a=n)||void 0===a?void 0:a.limit.toString():"10",sortDirection:s===Q.Backward?"desc":"asc",searchAfter:c}},p={refId:`log-context-${t.dataFrame.refId}-${s}`,metrics:[f],query:""},d=function(t,n){return n===Q.Forward?{from:(0,e.dateTime)(t).utc(),to:(0,e.dateTime)(t).add(7,"hours").utc()}:{from:(0,e.dateTime)(t).subtract(7,"hours").utc(),to:(0,e.dateTime)(t).utc()}}(t.timeEpochMs,s),g={from:d.from,to:d.to,raw:d},y=e.rangeUtil.calculateInterval(g,1);return{requestId:`log-context-request-${t.dataFrame.refId}-${null===(o=n)||void 0===o?void 0:o.direction}`,targets:[p],interval:y.interval,intervalMs:y.intervalMs,range:g,scopedVars:{},timezone:"UTC",app:e.CoreApp.Explore,startTime:Date.now(),hideFromInspector:!0}};var l,i=this;this.getLogRowContext=(l=Pe((function*(e,t){const r=i.makeLogContextDataRequest(e,t);return(0,n.lastValueFrom)(i.query(r).pipe(K((e=>{throw{message:"Error during context query. Please check JS console logs.",status:e.status,statusText:e.message}}))))})),function(e,t){return l.apply(this,arguments)});const a=t.jsonData||{};this.index=a.index||"",this.timeField="",this.timeOutputFormat="",this.queryBuilder=new z({timeField:this.timeField}),(0,n.from)(this.getResource("indexes/"+this.index)).pipe(j((e=>{let t=Le(e.index_config.doc_mapping.field_mappings),n=e.index_config.doc_mapping.timestamp_field,r=t.find((e=>e.json_path===n)),l=r&&r.field_mapping.output_format||"";return{field:n,format:l}})),K((e=>{if(!(e.data&&e.data.error||Te(e.data.error)))throw e;return(0,n.of)({field:"",format:""})}))).subscribe((e=>{this.timeField=e.field,this.timeOutputFormat=e.format,this.queryBuilder=new z({timeField:this.timeField})})),this.logMessageField=a.logMessageField||"",this.logLevelField=a.logLevelField||"",this.dataLinks=a.dataLinks||[],this.languageProvider=new be(this)}}function Le(e){const t=[];for(const n of e)if("object"===n.type&&void 0!==n.field_mappings)for(const e of Le(n.field_mappings))t.push({json_path:n.name+"."+e.json_path,path_segments:[n.name].concat(e.path_segments),field_mapping:e.field_mapping});else t.push({json_path:n.name,path_segments:[n.name],field_mapping:n});return t}const ke=(t,n,r)=>(t.fields=t.fields.map((l=>(l.type===e.FieldType.number&&(l.config=Ce({},l.config,function(t,n){const r=n&&t===e.LogLevel.unknown?"logs":t,l=Fe[t];return{displayNameFromDS:r,color:{mode:e.FieldColorModeId.Fixed,fixedColor:l},custom:{drawStyle:Z.Bars,barAlignment:te.Center,lineColor:l,pointColor:l,fillColor:l,lineWidth:1,fillOpacity:100,stacking:{mode:ee.Normal,group:"A"}}}}(n(t),r))),l))),t),Fe={[e.LogLevel.critical]:J.colors[7],[e.LogLevel.warning]:J.colors[1],[e.LogLevel.error]:J.colors[4],[e.LogLevel.info]:J.colors[0],[e.LogLevel.debug]:J.colors[5],[e.LogLevel.trace]:J.colors[2],[e.LogLevel.unknown]:"#8e8e8e"},Me=1,je=1e3*Me,xe=60*je,Ue=60*xe,Be=24*Ue;function Ve(e,t){if("string"==typeof e)return Ye(e);if(Array.isArray(e)){if(0===e.length)return"__empty__";const n=JSON.parse(t.query).field,r=e.map((e=>'"'+Ye(e)+'"'));return"string"!=typeof n?"IN ["+r.join(" ")+"]":r.join(" OR "+n+":")}return Ye(`${e}`)}function Ye(e){return!1===isNaN(+e)?e:e.replace(/([\!\*\+\-\=<>\s\&\|\(\)\[\]\{\}\^\~\?\:\\/"])/g,"\\$1")}function Ge(e){const t=(0,X.getDataSourceSrv)();if(e.datasourceUid){var n;const l=t.getInstanceSettings(e.datasourceUid);var r;return{title:e.urlDisplayLabel||"",url:"",internal:{query:{query:e.url},datasourceUid:e.datasourceUid,datasourceName:null!==(r=null===(n=l)||void 0===n?void 0:n.name)&&void 0!==r?r:"Data source not found"}}}return{title:e.urlDisplayLabel||"",url:e.url}}var We=c(650),He=c.n(We);function $e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){$e(e,t,n[t])}))}return e}function Qe(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}var Xe=c(644);const ze=({hideLine:e=!1})=>{const t=(0,J.useStyles2)(Je);return e?He().createElement("hr",{className:t.dividerHideLine}):He().createElement("hr",{className:t.divider})},Je=e=>({divider:(0,Xe.css)({margin:e.spacing(4,0)}),dividerHideLine:(0,Xe.css)({border:"none",margin:e.spacing(3,0)})});var Ze=c(988);function et(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){et(e,t,n[t])}))}return e}function nt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const rt=e=>{const{value:t,onChange:n,onDelete:r,suggestions:l,className:i}=e,a=(0,J.useStyles2)(lt),[o,s]=function(e){const[t,n]=(0,We.useState)(!!e),r=(l=e,i=(0,We.useRef)(),(0,We.useEffect)((function(){i.current=l})),i.current);var l,i;return(0,We.useEffect)((()=>{r||!e||t||n(!0),r&&!e&&t&&n(!1)}),[r,e,t]),[t,n]}(t.datasourceUid),u=e=>r=>{n(nt(tt({},t),{[e]:r.currentTarget.value}))};return He().createElement("div",{className:i},He().createElement("div",{className:a.firstRow},He().createElement(J.InlineField,{label:"Field",htmlFor:"elasticsearch-datasource-config-field",labelWidth:24,tooltip:"Can be exact field name or a regex pattern that will match on the field name."},He().createElement(J.Input,{type:"text",id:"elasticsearch-datasource-config-field",value:t.field,onChange:u("field"),width:100})),He().createElement(J.Button,{variant:"destructive",title:"Remove field",icon:"times",onClick:e=>{e.preventDefault(),r()}})),He().createElement(J.InlineFieldRow,null,He().createElement("div",{className:a.urlField},He().createElement(J.InlineLabel,{htmlFor:"elasticsearch-datasource-internal-link",width:24},o?"Query":"URL"),He().createElement(J.DataLinkInput,{placeholder:o?"${__value.raw}":"http://example.com/${__value.raw}",value:t.url||"",onChange:e=>n(nt(tt({},t),{url:e})),suggestions:l})),He().createElement("div",{className:a.urlDisplayLabelField},He().createElement(J.InlineField,{label:"URL Label",htmlFor:"elasticsearch-datasource-url-label",labelWidth:14,tooltip:"Use to override the button label."},He().createElement(J.Input,{type:"text",id:"elasticsearch-datasource-url-label",value:t.urlDisplayLabel,onChange:u("urlDisplayLabel")})))),He().createElement("div",{className:a.row},He().createElement(J.InlineField,{label:"Internal link",labelWidth:24},He().createElement(J.InlineSwitch,{label:"Internal link",value:o||!1,onChange:()=>{o&&n(nt(tt({},t),{datasourceUid:void 0})),s(!o)}})),o&&He().createElement(X.DataSourcePicker,{tracing:!0,onChange:e=>{n(nt(tt({},t),{datasourceUid:e.uid}))},current:t.datasourceUid})))},lt=()=>({firstRow:Xe.css`
    display: flex;
  `,nameField:Xe.css`
    flex: 2;
  `,regexField:Xe.css`
    flex: 3;
  `,row:Xe.css`
    display: flex;
    align-items: baseline;
  `,urlField:Xe.css`
    display: flex;
    flex: 1;
  `,urlDisplayLabelField:Xe.css`
    flex: 1;
  `}),it=e=>({addButton:Xe.css`
      margin-right: 10px;
    `,container:Xe.css`
      margin-bottom: ${e.spacing(2)};
    `,dataLink:Xe.css`
      margin-bottom: ${e.spacing(1)};
    `}),at=t=>{const{value:n,onChange:r}=t,l=(0,J.useStyles2)(it);return He().createElement(Ze.ConfigSubSection,{title:"Data links",description:"Add links to existing fields. Links will be shown in log row details next to the field value."},He().createElement("div",{className:l.container},n&&n.length>0&&He().createElement("div",{className:"gf-form-group"},n.map(((t,i)=>He().createElement(rt,{className:l.dataLink,key:i,value:t,onChange:e=>{const t=[...n];t.splice(i,1,e),r(t)},onDelete:()=>{const e=[...n];e.splice(i,1),r(e)},suggestions:[{value:e.DataLinkBuiltInVars.valueRaw,label:"Raw value",documentation:"Raw value of the field",origin:e.VariableOrigin.Value}]})))),He().createElement(J.Button,{type:"button",variant:"secondary",className:l.addButton,icon:"plus",onClick:e=>{e.preventDefault();const t=[...n||[],{field:"",url:"",base64TraceId:!0}];r(t)}},"Add")))};function ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function st(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ot(e,t,n[t])}))}return e}function ut(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const ct=({value:e,onChange:t})=>He().createElement("div",{className:"gf-form-group"},He().createElement(ze,{hideLine:!0}),He().createElement(at,{value:e.jsonData.dataLinks,onChange:n=>{t(ut(st({},e),{jsonData:ut(st({},e.jsonData),{dataLinks:n})}))}})),ft=({value:e,onChange:t})=>He().createElement(He().Fragment,null,He().createElement("div",{className:"gf-form-group"},He().createElement(J.FieldSet,{label:"Index settings"},He().createElement(J.InlineField,{label:"Index ID",labelWidth:26,tooltip:"Index ID. Required."},He().createElement(J.Input,{id:"quickwit_index_id",value:e.jsonData.index,onChange:n=>t(ut(st({},e),{jsonData:ut(st({},e.jsonData),{index:n.currentTarget.value})})),placeholder:"otel-logs-v0",width:40})),He().createElement(J.InlineField,{label:"Message field name",labelWidth:26,tooltip:"Field used to display a log line in the Explore view"},He().createElement(J.Input,{id:"quickwit_log_message_field",value:e.jsonData.logMessageField,onChange:n=>t(ut(st({},e),{jsonData:ut(st({},e.jsonData),{logMessageField:n.currentTarget.value})})),placeholder:"body.message",width:40})),He().createElement(J.InlineField,{label:"Log level field",labelWidth:26,tooltip:"The log level field must be a fast field"},He().createElement(J.Input,{id:"quickwit_log_level_field",value:e.jsonData.logLevelField,onChange:n=>t(ut(st({},e),{jsonData:ut(st({},e.jsonData),{logLevelField:n.currentTarget.value})})),placeholder:"level",width:40}))))),pt=(e,t,n)=>(0,We.useCallback)((r=>{e(n(t,r))}),[e,t,n]),dt=(0,We.createContext)(void 0),gt=()=>{const e=(0,We.useContext)(dt);if(!e)throw new Error("Use DispatchContext first.");return e},yt=[{label:"Avg",value:"avg"},{label:"Min",value:"min"},{label:"Max",value:"max"},{label:"Sum",value:"sum"},{label:"Count",value:"count"},{label:"Std Dev",value:"std_deviation"},{label:"Std Dev Upper",value:"std_deviation_bounds_upper"},{label:"Std Dev Lower",value:"std_deviation_bounds_lower"}],mt=[{label:"Simple",value:"simple"},{label:"Linear",value:"linear"},{label:"Exponentially Weighted",value:"ewma"},{label:"Holt Linear",value:"holt"},{label:"Holt Winters",value:"holt_winters"}];function vt(e="1"){return{type:"count",id:e}}function ht(e="1"){return{type:"logs",id:e}}function Et(e="1"){return{type:"date_histogram",id:e,settings:{interval:"auto"}}}function bt(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function qt(e){return!!e&&!!e[sn]}function Ot(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===un}(e)||Array.isArray(e)||!!e[on]||!!(null===(t=e.constructor)||void 0===t?void 0:t[on])||Rt(e)||Pt(e))}function wt(e,t,n){void 0===n&&(n=!1),0===St(e)?(n?Object.keys:cn)(e).forEach((function(r){n&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function St(e){var t=e[sn];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:Rt(e)?2:Pt(e)?3:0}function Tt(e,t){return 2===St(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function At(e,t,n){var r=St(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function It(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function Rt(e){return nn&&e instanceof Map}function Pt(e){return rn&&e instanceof Set}function Nt(e){return e.o||e.t}function Ct(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=fn(e);delete t[sn];for(var n=cn(t),r=0;r<n.length;r++){var l=n[r],i=t[l];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(t[l]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[l]})}return Object.create(Object.getPrototypeOf(e),t)}function _t(e,t){return void 0===t&&(t=!1),Lt(e)||qt(e)||!Ot(e)||(St(e)>1&&(e.set=e.add=e.clear=e.delete=Dt),Object.freeze(e),t&&wt(e,(function(e,t){return _t(t,!0)}),!0)),e}function Dt(){bt(2)}function Lt(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function kt(e){var t=pn[e];return t||bt(18,e),t}function Ft(){return en}function Mt(e,t){t&&(kt("Patches"),e.u=[],e.s=[],e.v=t)}function jt(e){xt(e),e.p.forEach(Bt),e.p=null}function xt(e){e===en&&(en=e.l)}function Ut(e){return en={p:[],l:en,h:e,m:!0,_:0}}function Bt(e){var t=e[sn];0===t.i||1===t.i?t.j():t.g=!0}function Vt(e,t){t._=t.p.length;var n=t.p[0],r=void 0!==e&&e!==n;return t.h.O||kt("ES5").S(t,e,r),r?(n[sn].P&&(jt(t),bt(4)),Ot(e)&&(e=Yt(t,e),t.l||Wt(t,e)),t.u&&kt("Patches").M(n[sn].t,e,t.u,t.s)):e=Yt(t,n,[]),jt(t),t.u&&t.v(t.u,t.s),e!==an?e:void 0}function Yt(e,t,n){if(Lt(t))return t;var r=t[sn];if(!r)return wt(t,(function(l,i){return Gt(e,r,t,l,i,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return Wt(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var l=4===r.i||5===r.i?r.o=Ct(r.k):r.o,i=l,a=!1;3===r.i&&(i=new Set(l),l.clear(),a=!0),wt(i,(function(t,i){return Gt(e,r,l,t,i,n,a)})),Wt(e,l,!1),n&&e.u&&kt("Patches").N(r,n,e.u,e.s)}return r.o}function Gt(e,t,n,r,l,i,a){if(qt(l)){var o=Yt(e,l,i&&t&&3!==t.i&&!Tt(t.R,r)?i.concat(r):void 0);if(At(n,r,o),!qt(o))return;e.m=!1}else a&&n.add(l);if(Ot(l)&&!Lt(l)){if(!e.h.D&&e._<1)return;Yt(e,l),t&&t.A.l||Wt(e,l)}}function Wt(e,t,n){void 0===n&&(n=!1),!e.l&&e.h.D&&e.m&&_t(t,n)}function Ht(e,t){var n=e[sn];return(n?Nt(n):e)[t]}function $t(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function Kt(e){e.P||(e.P=!0,e.l&&Kt(e.l))}function Qt(e){e.o||(e.o=Ct(e.t))}function Xt(e,t,n){var r=Rt(t)?kt("MapSet").F(t,n):Pt(t)?kt("MapSet").T(t,n):e.O?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:Ft(),P:!1,I:!1,R:{},l:t,t:e,k:null,o:null,j:null,C:!1},l=r,i=dn;n&&(l=[r],i=gn);var a=Proxy.revocable(l,i),o=a.revoke,s=a.proxy;return r.k=s,r.j=o,s}(t,n):kt("ES5").J(t,n);return(n?n.A:Ft()).p.push(r),r}function zt(e){return qt(e)||bt(22,e),function e(t){if(!Ot(t))return t;var n,r=t[sn],l=St(t);if(r){if(!r.P&&(r.i<4||!kt("ES5").K(r)))return r.t;r.I=!0,n=Jt(t,l),r.I=!1}else n=Jt(t,l);return wt(n,(function(t,l){r&&function(e,t){return 2===St(e)?e.get(t):e[t]}(r.t,t)===l||At(n,t,e(l))})),3===l?new Set(n):n}(e)}function Jt(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return Ct(e)}var Zt,en,tn="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),nn="undefined"!=typeof Map,rn="undefined"!=typeof Set,ln="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,an=tn?Symbol.for("immer-nothing"):((Zt={})["immer-nothing"]=!0,Zt),on=tn?Symbol.for("immer-draftable"):"__$immer_draftable",sn=tn?Symbol.for("immer-state"):"__$immer_state",un=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),cn="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,fn=Object.getOwnPropertyDescriptors||function(e){var t={};return cn(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},pn={},dn={get:function(e,t){if(t===sn)return e;var n=Nt(e);if(!Tt(n,t))return function(e,t,n){var r,l=$t(t,n);return l?"value"in l?l.value:null===(r=l.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!Ot(r)?r:r===Ht(e.t,t)?(Qt(e),e.o[t]=Xt(e.A.h,r,e)):r},has:function(e,t){return t in Nt(e)},ownKeys:function(e){return Reflect.ownKeys(Nt(e))},set:function(e,t,n){var r=$t(Nt(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var l=Ht(Nt(e),t),i=null==l?void 0:l[sn];if(i&&i.t===n)return e.o[t]=n,e.R[t]=!1,!0;if(It(n,l)&&(void 0!==n||Tt(e.t,t)))return!0;Qt(e),Kt(e)}return e.o[t]===n&&(void 0!==n||t in e.o)||Number.isNaN(n)&&Number.isNaN(e.o[t])||(e.o[t]=n,e.R[t]=!0),!0},deleteProperty:function(e,t){return void 0!==Ht(e.t,t)||t in e.t?(e.R[t]=!1,Qt(e),Kt(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=Nt(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){bt(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){bt(12)}},gn={};wt(dn,(function(e,t){gn[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),gn.deleteProperty=function(e,t){return gn.set.call(this,e,t,void 0)},gn.set=function(e,t,n){return dn.set.call(this,e[0],t,n,e[0])};var yn=function(){function e(e){var t=this;this.O=ln,this.D=!0,this.produce=function(e,n,r){if("function"==typeof e&&"function"!=typeof n){var l=n;n=e;var i=t;return function(e){var t=this;void 0===e&&(e=l);for(var r=arguments.length,a=Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];return i.produce(e,(function(e){var r;return(r=n).call.apply(r,[t,e].concat(a))}))}}var a;if("function"!=typeof n&&bt(6),void 0!==r&&"function"!=typeof r&&bt(7),Ot(e)){var o=Ut(t),s=Xt(t,e,void 0),u=!0;try{a=n(s),u=!1}finally{u?jt(o):xt(o)}return"undefined"!=typeof Promise&&a instanceof Promise?a.then((function(e){return Mt(o,r),Vt(e,o)}),(function(e){throw jt(o),e})):(Mt(o,r),Vt(a,o))}if(!e||"object"!=typeof e){if(void 0===(a=n(e))&&(a=e),a===an&&(a=void 0),t.D&&_t(a,!0),r){var c=[],f=[];kt("Patches").M(e,a,c,f),r(c,f)}return a}bt(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var r=arguments.length,l=Array(r>1?r-1:0),i=1;i<r;i++)l[i-1]=arguments[i];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(l))}))};var r,l,i=t.produce(e,n,(function(e,t){r=e,l=t}));return"undefined"!=typeof Promise&&i instanceof Promise?i.then((function(e){return[e,r,l]})):[i,r,l]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){Ot(e)||bt(8),qt(e)&&(e=zt(e));var t=Ut(this),n=Xt(this,e,void 0);return n[sn].C=!0,xt(t),n},t.finishDraft=function(e,t){var n=(e&&e[sn]).A;return Mt(n,t),Vt(void 0,n)},t.setAutoFreeze=function(e){this.D=e},t.setUseProxies=function(e){e&&!ln&&bt(20),this.O=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));var l=kt("Patches").$;return qt(e)?l(e,t):this.produce(e,(function(e){return l(e,t)}))},e}(),mn=new yn;mn.produce,mn.produceWithPatches.bind(mn),mn.setAutoFreeze.bind(mn),mn.setUseProxies.bind(mn),mn.applyPatches.bind(mn),mn.createDraft.bind(mn),mn.finishDraft.bind(mn);c(129);var vn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),hn=function(e,t){for(var n=0,r=t.length,l=e.length;n<r;n++,l++)e[l]=t[n];return e},En=Object.defineProperty,bn=Object.defineProperties,qn=Object.getOwnPropertyDescriptors,On=Object.getOwnPropertySymbols,wn=Object.prototype.hasOwnProperty,Sn=Object.prototype.propertyIsEnumerable,Tn=function(e,t,n){return t in e?En(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},An=function(e,t){for(var n in t||(t={}))wn.call(t,n)&&Tn(e,n,t[n]);if(On)for(var r=0,l=On(t);r<l.length;r++)n=l[r],Sn.call(t,n)&&Tn(e,n,t[n]);return e},In=function(e,t){return bn(e,qn(t))};function Rn(e,t){function n(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(t){var l=t.apply(void 0,n);if(!l)throw new Error("prepareAction did not return an object");return An(An({type:e,payload:l.payload},"meta"in l&&{meta:l.meta}),"error"in l&&{error:l.error})}return{type:e,payload:n[0]}}return n.toString=function(){return""+e},n.type=e,n.match=function(t){return t.type===e},n}"undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__,"undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__,function(e){function t(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var l=e.apply(this,n)||this;return Object.setPrototypeOf(l,t.prototype),l}vn(t,e),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.prototype.concat.apply(this,t)},t.prototype.prepend=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return 1===e.length&&Array.isArray(e[0])?new(t.bind.apply(t,hn([void 0],e[0].concat(this)))):new(t.bind.apply(t,hn([void 0],e.concat(this))))}}(Array),function(e){function t(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var l=e.apply(this,n)||this;return Object.setPrototypeOf(l,t.prototype),l}vn(t,e),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.prototype.concat.apply(this,t)},t.prototype.prepend=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return 1===e.length&&Array.isArray(e[0])?new(t.bind.apply(t,hn([void 0],e[0].concat(this)))):new(t.bind.apply(t,hn([void 0],e.concat(this))))}}(Array);var Pn=["name","message","stack","code"],Nn=function(e,t){this.payload=e,this.meta=t},Cn=function(e,t){this.payload=e,this.meta=t},_n=function(e){if("object"==typeof e&&null!==e){for(var t={},n=0,r=Pn;n<r.length;n++){var l=r[n];"string"==typeof e[l]&&(t[l]=e[l])}return t}return{message:String(e)}};function Dn(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}!function(){function e(e,t,n){var r=Rn(e+"/fulfilled",(function(e,t,n,r){return{payload:e,meta:In(An({},r||{}),{arg:n,requestId:t,requestStatus:"fulfilled"})}})),l=Rn(e+"/pending",(function(e,t,n){return{payload:void 0,meta:In(An({},n||{}),{arg:t,requestId:e,requestStatus:"pending"})}})),i=Rn(e+"/rejected",(function(e,t,r,l,i){return{payload:l,error:(n&&n.serializeError||_n)(e||"Rejected"),meta:In(An({},i||{}),{arg:r,requestId:t,rejectedWithValue:!!l,requestStatus:"rejected",aborted:"AbortError"===(null==e?void 0:e.name),condition:"ConditionError"===(null==e?void 0:e.name)})}})),a="undefined"!=typeof AbortController?AbortController:function(){function e(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return e.prototype.abort=function(){},e}();return Object.assign((function(e){return function(o,s,u){var c,f=(null==n?void 0:n.idGenerator)?n.idGenerator(e):function(e){void 0===e&&(e=21);for(var t="",n=e;n--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t}(),p=new a;function d(e){c=e,p.abort()}var g=function(){return a=this,g=null,y=function(){var a,g,y,m,v,h;return function(e,t){var n,r,l,i,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(l=2&i[0]?r.return:i[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,i[1])).done)return l;switch(r=0,l&&(i=[2&i[0],l.value]),i[0]){case 0:case 1:l=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((l=(l=a.trys).length>0&&l[l.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){a.label=i[1];break}if(6===i[0]&&a.label<l[1]){a.label=l[1],l=i;break}if(l&&a.label<l[2]){a.label=l[2],a.ops.push(i);break}l[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}}(this,(function(E){switch(E.label){case 0:return E.trys.push([0,4,,5]),null===(b=m=null==(a=null==n?void 0:n.condition)?void 0:a.call(n,e,{getState:s,extra:u}))||"object"!=typeof b||"function"!=typeof b.then?[3,2]:[4,m];case 1:m=E.sent(),E.label=2;case 2:if(!1===m||p.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return v=new Promise((function(e,t){return p.signal.addEventListener("abort",(function(){return t({name:"AbortError",message:c||"Aborted"})}))})),o(l(f,e,null==(g=null==n?void 0:n.getPendingMeta)?void 0:g.call(n,{requestId:f,arg:e},{getState:s,extra:u}))),[4,Promise.race([v,Promise.resolve(t(e,{dispatch:o,getState:s,extra:u,requestId:f,signal:p.signal,abort:d,rejectWithValue:function(e,t){return new Nn(e,t)},fulfillWithValue:function(e,t){return new Cn(e,t)}})).then((function(t){if(t instanceof Nn)throw t;return t instanceof Cn?r(t.payload,f,e,t.meta):r(t,f,e)}))])];case 3:return y=E.sent(),[3,5];case 4:return h=E.sent(),y=h instanceof Nn?i(null,f,e,h.payload,h.meta):i(h,f,e),[3,5];case 5:return n&&!n.dispatchConditionRejection&&i.match(y)&&y.meta.condition||o(y),[2,y]}var b}))},new Promise((function(e,t){var n=function(e){try{l(y.next(e))}catch(e){t(e)}},r=function(e){try{l(y.throw(e))}catch(e){t(e)}},l=function(t){return t.done?e(t.value):Promise.resolve(t.value).then(n,r)};l((y=y.apply(a,g)).next())}));var a,g,y}();return Object.assign(g,{abort:d,requestId:f,arg:e,unwrap:function(){return g.then(Dn)}})}}),{pending:l,rejected:i,fulfilled:r,typePrefix:e})}e.withTypes=function(){return e}}(),Object.assign;var Ln="listenerMiddleware";Rn(Ln+"/add"),Rn(Ln+"/removeAll"),Rn(Ln+"/remove"),"function"==typeof queueMicrotask&&queueMicrotask.bind("undefined"!=typeof window?window:void 0!==c.g?c.g:globalThis);"undefined"!=typeof window&&window.requestAnimationFrame&&window.requestAnimationFrame,function(){function e(e,t){var n=l[e];return n?n.enumerable=t:l[e]=n={configurable:!0,enumerable:t,get:function(){var t=this[sn];return dn.get(t,e)},set:function(t){var n=this[sn];dn.set(n,e,t)}},n}function t(e){for(var t=e.length-1;t>=0;t--){var l=e[t][sn];if(!l.P)switch(l.i){case 5:r(l)&&Kt(l);break;case 4:n(l)&&Kt(l)}}}function n(e){for(var t=e.t,n=e.k,r=cn(n),l=r.length-1;l>=0;l--){var i=r[l];if(i!==sn){var a=t[i];if(void 0===a&&!Tt(t,i))return!0;var o=n[i],s=o&&o[sn];if(s?s.t!==a:!It(o,a))return!0}}var u=!!t[sn];return r.length!==cn(t).length+(u?0:1)}function r(e){var t=e.k;if(t.length!==e.t.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);if(n&&!n.get)return!0;for(var r=0;r<t.length;r++)if(!t.hasOwnProperty(r))return!0;return!1}var l={};!function(e,t){pn[e]||(pn[e]=t)}("ES5",{J:function(t,n){var r=Array.isArray(t),l=function(t,n){if(t){for(var r=Array(n.length),l=0;l<n.length;l++)Object.defineProperty(r,""+l,e(l,!0));return r}var i=fn(n);delete i[sn];for(var a=cn(i),o=0;o<a.length;o++){var s=a[o];i[s]=e(s,t||!!i[s].enumerable)}return Object.create(Object.getPrototypeOf(n),i)}(r,t),i={i:r?5:4,A:n?n.A:Ft(),P:!1,I:!1,R:{},l:n,t,k:l,o:null,g:!1,C:!1};return Object.defineProperty(l,sn,{value:i,writable:!0}),l},S:function(e,n,l){l?qt(n)&&n[sn].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var n=t[sn];if(n){var l=n.t,i=n.k,a=n.R,o=n.i;if(4===o)wt(i,(function(t){t!==sn&&(void 0!==l[t]||Tt(l,t)?a[t]||e(i[t]):(a[t]=!0,Kt(n)))})),wt(l,(function(e){void 0!==i[e]||Tt(i,e)||(a[e]=!1,Kt(n))}));else if(5===o){if(r(n)&&(Kt(n),a.length=!0),i.length<l.length)for(var s=i.length;s<l.length;s++)a[s]=!1;else for(var u=l.length;u<i.length;u++)a[u]=!0;for(var c=Math.min(i.length,l.length),f=0;f<c;f++)i.hasOwnProperty(f)||(a[f]=!0),void 0===a[f]&&e(i[f])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?n(e):r(e)}})}();const kn=Rn("@metrics/add"),Fn=Rn("@metrics/remove"),Mn=Rn("@metrics/toggle_visibility"),jn=Rn("@metrics/change_field"),xn=Rn("@metrics/change_type"),Un=Rn("@metrics/change_attr"),Bn=Rn("@metrics/change_setting"),Vn=Rn("@metrics/change_meta"),Yn=Rn("init"),Gn=Rn("init_explore"),Wn=Rn("change_query"),Hn=Rn("change_alias_pattern"),$n=(e,t)=>Wn.match(t)?t.payload:Yn.match(t)||Gn.match(t)?e||"":e,Kn=(e,t)=>Hn.match(t)?t.payload:Yn.match(t)||Gn.match(t)?e||"":e,Qn=Rn("@bucketAggs/add"),Xn=Rn("@bucketAggs/remove"),zn=Rn("@bucketAggs/change_type"),Jn=Rn("@bucketAggs/change_field"),Zn=Rn("@bucketAggs/change_setting");function er(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){er(e,t,n[t])}))}return e}function nr(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function rr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){rr(e,t,n[t])}))}return e}function ir(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const ar=(e,t)=>{if(kn.match(t))return[...e,vt(t.payload)];if(Fn.match(t)){const n=e.find((e=>e.id===t.payload)),r=[n,...de(n,e)],l=e.filter((e=>!r.some((t=>t.id===e.id))));return 0===l.length?[vt("1")]:l}return xn.match(t)?e.filter((e=>"metrics"===pe[t.payload.type].impliedQueryType||e.id===t.payload.id)).map((e=>e.id!==t.payload.id?e:lr({id:e.id,type:t.payload.type},pe[t.payload.type].defaults))):jn.match(t)?e.map((e=>{if(e.id!==t.payload.id)return e;const n=ir(lr({},e),{field:t.payload.field});return se(e)?ir(lr({},n),{pipelineAgg:t.payload.field}):n})):Mn.match(t)?e.map((e=>e.id!==t.payload?e:ir(lr({},e),{hide:!e.hide}))):Bn.match(t)?e.map((e=>{if(e.id!==t.payload.metric.id)return e;if(ce(e)){const n=Ae(ir(lr({},e.settings),{[t.payload.settingName]:t.payload.newValue}));return ir(lr({},e),{settings:lr({},n)})}return e})):Vn.match(t)?e.map((e=>e.id!==t.payload.metric.id?e:(e=>pe[e.type].hasMeta)(e)?ir(lr({},e),{meta:ir(lr({},e.meta),{[t.payload.meta]:t.payload.newValue})}):e)):Un.match(t)?e.map((e=>e.id!==t.payload.metric.id?e:ir(lr({},e),{[t.payload.attribute]:t.payload.newValue}))):Yn.match(t)?(null===(n=e)||void 0===n?void 0:n.length)?e:[vt("1")]:Gn.match(t)?(null===(r=e)||void 0===r?void 0:r.length)?e:[ht("3")]:e;var n,r};function or(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const sr=(0,We.createContext)(void 0),ur=(0,We.createContext)(void 0),cr=(0,We.createContext)(void 0),fr=({children:t,onChange:n,onRunQuery:r,query:l,app:i,datasource:a,range:o})=>{const s=(0,We.useCallback)((e=>{n(e),r()}),[n,r]),u=(c={query:$n,alias:Kn,metrics:ar,bucketAggs:(f=a.timeField,(e,t)=>{if(Qn.match(t)){var n;const r={id:t.payload,type:"terms",settings:ge.terms.defaultSettings},l=e[e.length-1];return"date_histogram"===(null===(n=l)||void 0===n?void 0:n.type)?[...e.slice(0,e.length-1),r,l]:[...e,r]}return Xn.match(t)?e.filter((e=>e.id!==t.payload)):zn.match(t)?e.map((e=>e.id!==t.payload.id?e:{id:e.id,type:t.payload.newType,settings:ge[t.payload.newType].defaultSettings})):Jn.match(t)?e.map((e=>e.id!==t.payload.id?e:nr(tr({},e),{field:t.payload.newField}))):xn.match(t)?"metrics"!==pe[t.payload.type].impliedQueryType?[]:0===e.length?[nr(tr({},Et("2")),{field:f})]:e:Zn.match(t)?e.map((e=>{if(e.id!==t.payload.bucketAgg.id)return e;const n=Ae(nr(tr({},e.settings),{[t.payload.settingName]:t.payload.newValue}));return nr(tr({},e),{settings:tr({},n)})})):Yn.match(t)||Gn.match(t)?(null===(r=e)||void 0===r?void 0:r.length)?e:[nr(tr({},Et("2")),{field:f})]:e;var r})},(e,t)=>{const n={};for(const r in c)n[r]=c[r](e[r],t);return n});var c,f;const p=pt((e=>{return s((t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){or(e,t,n[t])}))}return e}({},l,e),n=null!=(n={timeField:a.timeField})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t));var t,n}),l,u),d=!l.metrics||!l.bucketAggs||void 0===l.query,[g,y]=(0,We.useState)(d);return(0,We.useEffect)((()=>{g&&(i===e.CoreApp.Explore?p(Gn()):p(Yn()),y(!1))}),[g,p,i]),d?null:He().createElement(sr.Provider,{value:a},He().createElement(ur.Provider,{value:l},He().createElement(cr.Provider,{value:o},He().createElement(dt.Provider,{value:p},t))))},pr=e=>()=>{const t=(0,We.useContext)(e);if(!t)throw new Error("use ElasticsearchProvider first.");return t},dr=pr(ur),gr=pr(sr),yr=pr(cr),mr=e=>e.id,vr=e=>parseInt(e,10);function hr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Er=Xe.css`
  clip: rect(0 0 0 0);
  clip-path: inset(50%);
  height: 1px;
  overflow: hidden;
  position: absolute;
  white-space: nowrap;
  width: 1px;
`,br=e=>{var{iconName:t,onClick:n,className:r,label:l}=e,i=function(e,t){if(null==e)return{};var n,r,l=function(e,t){if(null==e)return{};var n,r,l={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}(e,["iconName","onClick","className","label"]);return He().createElement("button",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){hr(e,t,n[t])}))}return e}({className:(0,Xe.cx)("gf-form-label gf-form-label--btn query-part",r),onClick:n},i),He().createElement("span",{className:Er},l),He().createElement(J.Icon,{name:t,"aria-hidden":"true"}))},qr=({children:e,label:n,onRemoveClick:r,onHideClick:l,hidden:i=!1})=>{const a=(0,J.useStyles2)(Or);return He().createElement(J.InlineFieldRow,null,He().createElement(J.InlineSegmentGroup,null,He().createElement(J.InlineLabel,{width:17,as:"div"},He().createElement("span",null,n),He().createElement("span",{className:a.iconWrapper},l&&He().createElement(J.IconButton,{name:i?"eye-slash":"eye",onClick:l,size:"sm","aria-pressed":i,"aria-label":"hide metric",className:a.icon,type:"button"}),He().createElement(J.IconButton,{name:"trash-alt",size:"sm",className:a.icon,onClick:r||t.noop,disabled:!r,"aria-label":"remove metric",type:"button"})))),e)},Or=e=>({iconWrapper:Xe.css`
      display: flex;
    `,icon:Xe.css`
      color: ${e.colors.text.secondary};
      margin-left: ${e.spacing(.25)};
    `});function wr(e,t,n,r,l,i,a){try{var o=e[i](a),s=o.value}catch(e){return void n(e)}o.done?t(s):Promise.resolve(s).then(r,l)}const Sr=({text:e})=>({label:e,value:e}),Tr=e=>{const t=gr(),r=yr(),l=Array.isArray(e)?e:(e=>{if((e=>fe.includes(e))(e))return"cardinality"===e?[]:["number"];if((e=>Ee.includes(e))(e))switch(e){case"date_histogram":return["date"];case"geohash_grid":return["geo_point"];case"histogram":return["number"];default:return[]}return[]})(e);let i;return a=function*(e){return i||(i=yield(0,n.lastValueFrom)(t.getFields(!0,l,r))),i.filter((({text:t})=>void 0===e||t.includes(e))).map(Sr)},o=function(){var e=this,t=arguments;return new Promise((function(n,r){var l=a.apply(e,t);function i(e){wr(l,n,r,i,o,"next",e)}function o(e){wr(l,n,r,i,o,"throw",e)}i(void 0)}))},function(e){return o.apply(this,arguments)};var a,o},Ar=Xe.css`
  min-width: 150px;
`,Ir=({label:e,children:t,hidden:n=!1})=>{const[r,l]=(0,We.useState)(!1),i=((e,t)=>({wrapper:Xe.css`
      max-width: 500px;
      display: flex;
      flex-direction: column;
    `,settingsWrapper:Xe.css`
      padding-top: ${e.spacing(.5)};
    `,icon:Xe.css`
      margin-right: ${e.spacing(.5)};
    `,button:Xe.css`
      justify-content: start;
      ${t&&Xe.css`
        color: ${e.colors.text.disabled};
      `}
    `}))((0,J.useTheme2)(),n);return He().createElement(J.InlineSegmentGroup,null,He().createElement("div",{className:(0,Xe.cx)(i.wrapper)},He().createElement("button",{className:(0,Xe.cx)("gf-form-label query-part",i.button,Ar),onClick:()=>l(!r),"aria-expanded":r,type:"button"},He().createElement(J.Icon,{name:r?"angle-down":"angle-right","aria-hidden":"true",className:i.icon}),e),r&&He().createElement("div",{className:i.settingsWrapper},t)))},Rr=({options:e,value:t,onChange:n})=>{const[r,l]=(0,We.useState)(((e,t)=>{return void 0===t||e.some((n=t,({value:e})=>e===n))?e:[...e,{value:t,label:t}];var n})(e,t));return{onCreateOption:e=>{var t;t=e,l([...r,{value:t,label:t}]),n({value:e})},onChange:n,allowCustomValue:!0,options:r,value:t}};function Pr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Pr(e,t,n[t])}))}return e}function Cr(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const _r=[{label:"auto",value:"auto"},{label:"10s",value:"10s"},{label:"1m",value:"1m"},{label:"5m",value:"5m"},{label:"10m",value:"10m"},{label:"20m",value:"20m"},{label:"1h",value:"1h"},{label:"1d",value:"1d"}],Dr=(e,t,n)=>{var r;return!n.some((r=e,({value:e})=>e===r))&&e.trim().length>0},Lr=(e,t)=>{var n;return(null===(n=e.value)||void 0===n?void 0:n.startsWith(t))||!1},kr=({bucketAgg:n})=>{var r,l,i,a,o,s,u,c,f,p;const d=gt(),{current:g}=(0,We.useRef)((0,t.uniqueId)("es-date_histogram-"));return He().createElement(He().Fragment,null,He().createElement(J.InlineField,Nr({label:"Interval"},Zr),He().createElement(J.Select,Nr({inputId:(0,t.uniqueId)("es-date_histogram-interval"),isValidNewOption:Dr,filterOption:Lr},Rr({options:_r,value:(null===(r=n.settings)||void 0===r?void 0:r.interval)||(null===(l=ge.date_histogram.defaultSettings)||void 0===l?void 0:l.interval),onChange:({value:e})=>d(Zn({bucketAgg:n,settingName:"interval",newValue:e}))})))),He().createElement(J.InlineField,Nr({label:"Min Doc Count"},Zr),He().createElement(J.Input,{id:`${g}-min_doc_count`,onBlur:e=>d(Zn({bucketAgg:n,settingName:"min_doc_count",newValue:e.target.value})),defaultValue:(null===(i=n.settings)||void 0===i?void 0:i.min_doc_count)||(null===(a=ge.date_histogram.defaultSettings)||void 0===a?void 0:a.min_doc_count)})),He().createElement(J.InlineField,Cr(Nr({label:"Trim Edges"},Zr),{tooltip:"Trim the edges on the timeseries datapoints"}),He().createElement(J.Input,{id:`${g}-trime_edges`,onBlur:e=>d(Zn({bucketAgg:n,settingName:"trimEdges",newValue:e.target.value})),defaultValue:(null===(o=n.settings)||void 0===o?void 0:o.trimEdges)||(null===(s=ge.date_histogram.defaultSettings)||void 0===s?void 0:s.trimEdges)})),He().createElement(J.InlineField,Cr(Nr({label:"Offset"},Zr),{tooltip:"Change the start value of each bucket by the specified positive (+) or negative offset (-) duration, such as 1h for an hour, or 1d for a day"}),He().createElement(J.Input,{id:`${g}-offset`,onBlur:e=>d(Zn({bucketAgg:n,settingName:"offset",newValue:e.target.value})),defaultValue:(null===(u=n.settings)||void 0===u?void 0:u.offset)||(null===(c=ge.date_histogram.defaultSettings)||void 0===c?void 0:c.offset)})),He().createElement(J.InlineField,Nr({label:"Timezone"},Zr),He().createElement(J.TimeZonePicker,{value:(null===(f=n.settings)||void 0===f?void 0:f.timeZone)||(null===(p=ge.date_histogram.defaultSettings)||void 0===p?void 0:p.timeZone),includeInternal:[e.InternalTimeZones.utc],onChange:e=>{d(Zn({bucketAgg:n,settingName:"timeZone",newValue:e}))}})))},Fr=({index:e,onAdd:t,onRemove:n,elements:r})=>He().createElement("div",{className:Xe.css`
        display: flex;
      `},0===e&&He().createElement(br,{iconName:"plus",onClick:t,label:"add"}),r.length>=2&&He().createElement(br,{iconName:"minus",onClick:n,label:"remove"})),Mr=Rn("@bucketAggregations/filter/add"),jr=Rn("@bucketAggregations/filter/remove"),xr=Rn("@bucketAggregations/filter/change"),Ur=(e=[],t)=>Mr.match(t)?[...e,{label:"",query:"*"}]:jr.match(t)?e.slice(0,t.payload).concat(e.slice(t.payload+1)):xr.match(t)?e.map(((e,n)=>n!==t.payload.index?e:t.payload.filter)):e;function Br(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Br(e,t,n[t])}))}return e}function Yr(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const Gr=({bucketAgg:e})=>{var n,r,l,i;const{current:a}=(0,We.useRef)((0,t.uniqueId)("es-filters-")),o=gt(),s=pt((t=>o(Zn({bucketAgg:e,settingName:"filters",newValue:t}))),null===(n=e.settings)||void 0===n?void 0:n.filters,Ur);return(0,We.useEffect)((()=>{var t,n;(null===(n=e.settings)||void 0===n||null===(t=n.filters)||void 0===t?void 0:t.length)||s(Mr())}),[s,null===(l=e.settings)||void 0===l||null===(r=l.filters)||void 0===r?void 0:r.length]),He().createElement(He().Fragment,null,He().createElement("div",{className:Xe.css`
          display: flex;
          flex-direction: column;
        `},(null===(i=e.settings)||void 0===i?void 0:i.filters).map(((t,n)=>{var r;return He().createElement("div",{key:n,className:Xe.css`
              display: flex;
            `},He().createElement(J.InlineField,{label:"Query",labelWidth:8},He().createElement("div",{className:Xe.css`
                  width: 150px;
                `},He().createElement(J.QueryField,{placeholder:"Lucene Query",portalOrigin:"elasticsearch",onBlur:()=>{},onChange:e=>s(xr({index:n,filter:Yr(Vr({},t),{query:e})})),query:t.query}))),He().createElement(J.InlineField,{label:"Label",labelWidth:8},He().createElement(J.Input,{width:16,id:`${a}-label-${n}`,placeholder:"Label",onBlur:e=>s(xr({index:n,filter:Yr(Vr({},t),{label:e.target.value})})),defaultValue:t.label})),He().createElement(Fr,{index:n,elements:(null===(r=e.settings)||void 0===r?void 0:r.filters)||[],onAdd:()=>s(Mr()),onRemove:()=>s(jr(n))}))}))))};function Wr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Wr(e,t,n[t])}))}return e}const $r=({bucketAgg:e})=>{var n,r,l,i,a,o,s,u;const{metrics:c}=dr(),f=Qr(c),{current:p}=(0,We.useRef)((0,t.uniqueId)("es-terms-")),d=gt();return He().createElement(He().Fragment,null,He().createElement(J.InlineField,Hr({label:"Order"},Zr),He().createElement(J.Select,{inputId:`${p}-order`,onChange:t=>d(Zn({bucketAgg:e,settingName:"order",newValue:t.value})),options:me,value:(null===(n=e.settings)||void 0===n?void 0:n.order)||(null===(r=ge.terms.defaultSettings)||void 0===r?void 0:r.order)})),He().createElement(J.InlineField,Hr({label:"Size"},Zr),He().createElement(J.Select,Hr({inputId:`${p}-size`},Rr({options:ve,value:(null===(l=e.settings)||void 0===l?void 0:l.size)||(null===(i=ge.terms.defaultSettings)||void 0===i?void 0:i.size),onChange({value:t}){d(Zn({bucketAgg:e,settingName:"size",newValue:t}))}})))),He().createElement(J.InlineField,Hr({label:"Min Doc Count"},Zr),He().createElement(J.Input,{id:`${p}-min_doc_count`,onBlur:t=>d(Zn({bucketAgg:e,settingName:"min_doc_count",newValue:t.target.value})),defaultValue:(null===(a=e.settings)||void 0===a?void 0:a.min_doc_count)||(null===(o=ge.terms.defaultSettings)||void 0===o?void 0:o.min_doc_count)})),He().createElement(J.InlineField,Hr({label:"Order By"},Zr),He().createElement(J.Select,{inputId:`${p}-order_by`,onChange:t=>d(Zn({bucketAgg:e,settingName:"orderBy",newValue:t.value})),options:f,value:(null===(s=e.settings)||void 0===s?void 0:s.orderBy)||(null===(u=ge.terms.defaultSettings)||void 0===u?void 0:u.orderBy)})))};function Kr(e){return"top_metrics"!==e.type&&!se(e)}const Qr=(e=[])=>{const t=e.filter(Kr).flatMap((e=>"extended_stats"===e.type?function(e){return e.meta?Object.keys(e.meta).filter((t=>{var n;return null===(n=e.meta)||void 0===n?void 0:n[t]})).map((t=>{let n=t;return"std_deviation_bounds_lower"===t&&(n="std_lower"),"std_deviation_bounds_upper"===t&&(n="std_upper"),{label:`${Se(e)} (${n})`,value:`${e.id}[${n}]`}})):[]}(e):"percentiles"===e.type?function(e){var t;return(null===(t=e.settings)||void 0===t?void 0:t.percents)?e.settings.percents.map((t=>{const n=/^\d+\.\d+/.test(`${t}`)?t:`${t}.0`;return{label:`${Se(e)} (${t})`,value:`${e.id}[${n}]`}})):[]}(e):{label:Se(e),value:e.id}));return[...ye,...t]},Xr=e=>t=>t.value===e;function zr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){zr(e,t,n[t])}))}return e}const Zr={labelWidth:16},el=({bucketAgg:e})=>{var n,r,l,i,a,o;const{current:s}=(0,We.useRef)((0,t.uniqueId)("es-setting-")),u=gt(),c=(e=>{const{metrics:t}=dr();switch(e.type){case"terms":{var n,r,l,i;const s=(null===(n=e.settings)||void 0===n?void 0:n.order)||"desc",u=(null===(r=e.settings)||void 0===r?void 0:r.size)||"10",c=parseInt((null===(l=e.settings)||void 0===l?void 0:l.min_doc_count)||"0",10),f=(null===(i=e.settings)||void 0===i?void 0:i.orderBy)||"_term";let p="";var a;"0"!==u&&(p=`${null===(a=me.find(Xr(s)))||void 0===a?void 0:a.label} ${u}, `),c>0&&(p+=`Min Doc Count: ${c}, `),p+="Order by: ";const d=ye.find(Xr(f));if(d)p+=d.label;else{var o;const e=null===(o=t)||void 0===o?void 0:o.find((e=>e.id===(e=>{const t=e.match(/^(\d+)/);return t?t[1]:void 0})(f)));p+=e?Se(e):"metric not found"}return"0"===u&&(p+=` (${s})`),p}case"histogram":{var s,u;const t=(null===(s=e.settings)||void 0===s?void 0:s.interval)||1e3,n=(null===(u=e.settings)||void 0===u?void 0:u.min_doc_count)||1;return`Interval: ${t}${"number"==typeof n&&n>0?`, Min Doc Count: ${n}`:""}`}case"filters":var c,f;return`Filter Queries (${((null===(c=e.settings)||void 0===c?void 0:c.filters)||(null===(f=ge.filters.defaultSettings)||void 0===f?void 0:f.filters)).length})`;case"geohash_grid":var p;return`Precision: ${Math.max(Math.min(parseInt((null===(p=e.settings)||void 0===p?void 0:p.precision)||"5",10),12),1)}`;case"date_histogram":{var d,g,y;const t=(null===(d=e.settings)||void 0===d?void 0:d.interval)||"auto",n=(null===(g=e.settings)||void 0===g?void 0:g.min_doc_count)||0,r=(null===(y=e.settings)||void 0===y?void 0:y.trimEdges)||0;let l=`Interval: ${t}`;return"number"==typeof n&&n>0&&(l+=`, Min Doc Count: ${n}`),"number"==typeof r&&r>0&&(l+=`, Trim edges: ${r}`),l}default:return"Settings"}})(e);return He().createElement(Ir,{label:c},"terms"===e.type&&He().createElement($r,{bucketAgg:e}),"date_histogram"===e.type&&He().createElement(kr,{bucketAgg:e}),"filters"===e.type&&He().createElement(Gr,{bucketAgg:e}),"geohash_grid"===e.type&&He().createElement(J.InlineField,Jr({label:"Precision"},Zr),He().createElement(J.Input,{id:`${s}-geohash_grid-precision`,onBlur:t=>u(Zn({bucketAgg:e,settingName:"precision",newValue:t.target.value})),defaultValue:(null===(n=e.settings)||void 0===n?void 0:n.precision)||(null===(r=ge[e.type].defaultSettings)||void 0===r?void 0:r.precision)})),"histogram"===e.type&&He().createElement(He().Fragment,null,He().createElement(J.InlineField,Jr({label:"Interval"},Zr),He().createElement(J.Input,{id:`${s}-histogram-interval`,onBlur:t=>u(Zn({bucketAgg:e,settingName:"interval",newValue:t.target.value})),defaultValue:(null===(l=e.settings)||void 0===l?void 0:l.interval)||(null===(i=ge[e.type].defaultSettings)||void 0===i?void 0:i.interval)})),He().createElement(J.InlineField,Jr({label:"Min Doc Count"},Zr),He().createElement(J.Input,{id:`${s}-histogram-min_doc_count`,onBlur:t=>u(Zn({bucketAgg:e,settingName:"min_doc_count",newValue:t.target.value})),defaultValue:(null===(a=e.settings)||void 0===a?void 0:a.min_doc_count)||(null===(o=ge[e.type].defaultSettings)||void 0===o?void 0:o.min_doc_count)}))))},tl=["date_histogram","terms","histogram"],nl=Object.entries(ge).map((([e,{label:t}])=>({label:t,value:e}))).filter((({value:e})=>tl.includes(e))),rl=({value:e})=>{const t=gt(),n=Tr(e.type);return He().createElement(He().Fragment,null,He().createElement(J.InlineSegmentGroup,null,He().createElement(J.Segment,{className:Ar,options:nl,onChange:n=>t(zn({id:e.id,newType:n.value})),value:(r=e,{label:ge[r.type].label,value:r.type})}),he(e)&&He().createElement(J.SegmentAsync,{className:Ar,loadOptions:n,onChange:n=>t(Jn({id:e.id,newField:n.value})),placeholder:"Select Field",value:e.field})),He().createElement(el,{bucketAgg:e}));var r},ll=({nextId:e})=>{var t;const n=gt(),{bucketAggs:r}=dr(),l=(null===(t=r)||void 0===t?void 0:t.length)||0;return He().createElement(He().Fragment,null,r.map(((t,r)=>He().createElement(qr,{key:`${t.type}-${t.id}`,label:0===r?"Group By":"Then By",onRemoveClick:l>1&&(()=>n(Xn(t.id)))},He().createElement(rl,{value:t}),0===r&&He().createElement(br,{iconName:"plus",onClick:()=>n(Qn(e)),label:"add"})))))},il=Xe.css`
  white-space: nowrap;
`,al=e=>({label:Se(e),value:e}),ol=({options:e,onChange:t,className:n,value:r})=>{const l=e.find((e=>e.id===r));return He().createElement(J.Segment,{className:(0,Xe.cx)(n,il),options:(i=e,i.map(al).filter((e=>!0))),onChange:t,placeholder:"Select Metric",value:l?al(l):void 0});var i};function sl({label:e,settingName:n,metric:r,placeholder:l,tooltip:i}){var a;const o=gt(),[s]=(0,We.useState)((0,t.uniqueId)("es-field-id-"));let u=(null===(a=r.settings)||void 0===a?void 0:a[n])||"";return He().createElement(J.InlineField,{label:e,labelWidth:16,tooltip:i},He().createElement(J.Input,{id:s,placeholder:l,onBlur:e=>o(Bn({metric:r,settingName:n,newValue:e.target.value})),defaultValue:u}))}const ul=Rn("@pipelineVariables/add"),cl=Rn("@pipelineVariables/remove"),fl=Rn("@pipelineVariables/rename"),pl=Rn("@pipelineVariables/change_metric");function dl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){dl(e,t,n[t])}))}return e}function yl(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const ml=(e=[],t)=>ul.match(t)?[...e,ne(re(e))]:cl.match(t)?e.slice(0,t.payload).concat(e.slice(t.payload+1)):fl.match(t)?e.map(((e,n)=>n!==t.payload.index?e:yl(gl({},e),{name:t.payload.newName}))):pl.match(t)?e.map(((e,n)=>n!==t.payload.index?e:yl(gl({},e),{pipelineAgg:t.payload.newMetric}))):e,vl=({value:e,previousMetrics:n})=>{var r;const l=gt(),i=pt((t=>l(Un({metric:e,attribute:"pipelineVariables",newValue:t}))),e.pipelineVariables,ml);return(0,We.useEffect)((()=>{var t;(null===(t=e.pipelineVariables)||void 0===t?void 0:t.length)||i(ul())}),[i,null===(r=e.pipelineVariables)||void 0===r?void 0:r.length]),He().createElement(He().Fragment,null,He().createElement("div",{className:Xe.css`
          display: flex;
        `},He().createElement(J.InlineLabel,{width:16},"Variables"),He().createElement("div",{className:Xe.css`
            display: grid;
            grid-template-columns: 1fr auto;
            row-gap: 4px;
            margin-bottom: 4px;
          `},e.pipelineVariables.map(((r,l)=>He().createElement(We.Fragment,{key:(0,t.uniqueId)("es-bs-")},He().createElement("div",{className:Xe.css`
                  display: grid;
                  column-gap: 4px;
                  grid-template-columns: auto auto;
                `},He().createElement(J.Input,{"aria-label":"Variable name",defaultValue:r.name,placeholder:"Variable Name",onBlur:e=>i(fl({newName:e.target.value,index:l}))}),He().createElement(ol,{onChange:e=>i(pl({newMetric:e.value.id,index:l})),options:n,value:r.pipelineAgg})),He().createElement(Fr,{index:l,elements:e.pipelineVariables||[],onAdd:()=>i(ul()),onRemove:()=>i(cl(l))})))))),He().createElement(sl,{label:"Script",metric:e,settingName:"script",tooltip:"Elasticsearch v5.0 and above: Scripting language is Painless. Use params.<var> to reference a variable. Elasticsearch pre-v5.0: Scripting language is per default Groovy if not changed. For Groovy use <var> to reference a variable.",placeholder:"params.var1 / params.var2"}))};function hl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function El(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){hl(e,t,n[t])}))}return e}function bl(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const ql=({metric:e})=>{var n,r,l,i,a,o,s,u,c,f,p,d;const g=gt(),{current:y}=(0,We.useRef)((0,t.uniqueId)("es-moving-avg-"));return He().createElement(He().Fragment,null,He().createElement(J.InlineField,{label:"Model",labelWidth:16},He().createElement(J.Select,{inputId:`${y}-model`,onChange:t=>g(Bn({metric:e,settingName:"model",newValue:t.value})),options:mt,value:null===(n=e.settings)||void 0===n?void 0:n.model})),He().createElement(sl,{label:"Window",settingName:"window",metric:e,placeholder:"5"}),He().createElement(sl,{label:"Predict",settingName:"predict",metric:e}),(le(e)||ie(e)||ae(e))&&He().createElement(J.InlineField,{label:"Alpha",labelWidth:16},He().createElement(J.Input,{id:`${y}-alpha`,onBlur:t=>{var n;return g(Bn({metric:e,settingName:"settings",newValue:bl(El({},null===(n=e.settings)||void 0===n?void 0:n.settings),{alpha:t.target.value})}))},defaultValue:null===(l=e.settings)||void 0===l||null===(r=l.settings)||void 0===r?void 0:r.alpha})),(ie(e)||ae(e))&&He().createElement(J.InlineField,{label:"Beta",labelWidth:16},He().createElement(J.Input,{id:`${y}-beta`,onBlur:t=>{var n;return g(Bn({metric:e,settingName:"settings",newValue:bl(El({},null===(n=e.settings)||void 0===n?void 0:n.settings),{beta:t.target.value})}))},defaultValue:null===(a=e.settings)||void 0===a||null===(i=a.settings)||void 0===i?void 0:i.beta})),ae(e)&&He().createElement(He().Fragment,null,He().createElement(J.InlineField,{label:"Gamma",labelWidth:16},He().createElement(J.Input,{id:`${y}-gamma`,onBlur:t=>{var n;return g(Bn({metric:e,settingName:"settings",newValue:bl(El({},null===(n=e.settings)||void 0===n?void 0:n.settings),{gamma:t.target.value})}))},defaultValue:null===(s=e.settings)||void 0===s||null===(o=s.settings)||void 0===o?void 0:o.gamma})),He().createElement(J.InlineField,{label:"Period",labelWidth:16},He().createElement(J.Input,{id:`${y}-period`,onBlur:t=>{var n;return g(Bn({metric:e,settingName:"settings",newValue:bl(El({},null===(n=e.settings)||void 0===n?void 0:n.settings),{period:t.target.value})}))},defaultValue:null===(c=e.settings)||void 0===c||null===(u=c.settings)||void 0===u?void 0:u.period})),He().createElement(J.InlineField,{label:"Pad",labelWidth:16},He().createElement(J.InlineSwitch,{id:`${y}-pad`,onChange:t=>{var n;return g(Bn({metric:e,settingName:"settings",newValue:bl(El({},null===(n=e.settings)||void 0===n?void 0:n.settings),{pad:t.target.checked})}))},checked:!!(null===(p=e.settings)||void 0===p||null===(f=p.settings)||void 0===f?void 0:f.pad)}))),(le(e)||ie(e)||ae(e))&&He().createElement(J.InlineField,{label:"Minimize",labelWidth:16},He().createElement(J.InlineSwitch,{id:`${y}-minimize`,onChange:t=>g(Bn({metric:e,settingName:"minimize",newValue:t.target.checked})),checked:!!(null===(d=e.settings)||void 0===d?void 0:d.minimize)})))},Ol=e=>({value:e,label:e}),wl=({metric:e})=>{var t,n,r,l;const i=gt(),a=Tr(["number","date"]),o=Tr(e.type);return He().createElement(He().Fragment,null,He().createElement(J.InlineField,{label:"Metrics",labelWidth:16},He().createElement(J.AsyncMultiSelect,{onChange:t=>i(Bn({metric:e,settingName:"metrics",newValue:t.map((e=>e.value))})),loadOptions:o,value:null===(n=e.settings)||void 0===n||null===(t=n.metrics)||void 0===t?void 0:t.map(Ol),closeMenuOnSelect:!1,defaultOptions:!0})),He().createElement(J.InlineField,{label:"Order",labelWidth:16},He().createElement(J.Select,{onChange:t=>i(Bn({metric:e,settingName:"order",newValue:t.value})),options:me,value:null===(r=e.settings)||void 0===r?void 0:r.order})),He().createElement(J.InlineField,{label:"Order By",labelWidth:16,className:Xe.css`
          & > div {
            width: 100%;
          }
        `},He().createElement(J.SegmentAsync,{className:Xe.css`
            margin-right: 0;
          `,loadOptions:a,onChange:t=>i(Bn({metric:e,settingName:"orderBy",newValue:t.value})),placeholder:"Select Field",value:null===(l=e.settings)||void 0===l?void 0:l.orderBy})))};function Sl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Tl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Sl(e,t,n[t])}))}return e}function Al(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const Il={labelWidth:16},Rl=({metric:e,previousMetrics:n})=>{var r,l,i,a,o,s;const{current:u}=(0,We.useRef)((0,t.uniqueId)("es-setting-")),c=gt(),f=(e=>{switch(e.type){case"cardinality":var t;return`Precision threshold: ${(null===(t=e.settings)||void 0===t?void 0:t.precision_threshold)||""}`;case"percentiles":var n,r,l,i;return(null===(n=e.settings)||void 0===n?void 0:n.percents)&&(null===(l=e.settings)||void 0===l||null===(r=l.percents)||void 0===r?void 0:r.length)>=1?`Values: ${null===(i=e.settings)||void 0===i?void 0:i.percents}`:"Percents: Default";case"extended_stats":{const t=Object.entries(e.meta||{}).map((([e,t])=>{var n;return t&&(null===(n=yt.find((e=>t=>t.value===e)(e)))||void 0===n?void 0:n.label)})).filter(Boolean);return`Stats: ${t.length>0?t.join(", "):"None selected"}`}case"raw_document":case"raw_data":var a;return`Size: ${(null===(a=e.settings)||void 0===a?void 0:a.size)||100}`;default:return"Options"}})(e),p=dr();var d;return He().createElement(Ir,{label:f,hidden:e.hide},"derivative"===e.type&&He().createElement(sl,{label:"Unit",metric:e,settingName:"unit"}),"serial_diff"===e.type&&He().createElement(sl,{label:"Lag",metric:e,settingName:"lag",placeholder:"1"}),"cumulative_sum"===e.type&&He().createElement(sl,{label:"Format",metric:e,settingName:"format"}),"moving_avg"===e.type&&He().createElement(ql,{metric:e}),"moving_fn"===e.type&&He().createElement(He().Fragment,null,He().createElement(sl,{label:"Window",metric:e,settingName:"window"}),He().createElement(sl,{label:"Script",metric:e,settingName:"script"}),He().createElement(sl,{label:"Shift",metric:e,settingName:"shift"})),"top_metrics"===e.type&&He().createElement(wl,{metric:e}),"bucket_script"===e.type&&He().createElement(vl,{value:e,previousMetrics:n}),("raw_data"===e.type||"raw_document"===e.type)&&He().createElement(J.InlineField,Tl({label:"Size"},Il),He().createElement(J.Input,{id:`ES-query-${p.refId}_metric-${e.id}-size`,onBlur:t=>c(Bn({metric:e,settingName:"size",newValue:t.target.value})),defaultValue:null!==(d=null===(r=e.settings)||void 0===r?void 0:r.size)&&void 0!==d?d:null===(l=pe.raw_data.defaults.settings)||void 0===l?void 0:l.size})),"logs"===e.type&&He().createElement(sl,{label:"Limit",metric:e,settingName:"limit",placeholder:"100"}),"cardinality"===e.type&&He().createElement(sl,{label:"Precision Threshold",metric:e,settingName:"precision_threshold"}),"extended_stats"===e.type&&He().createElement(He().Fragment,null,yt.map((t=>{var n,r,l;return He().createElement(Pl,{key:t.value,stat:t,onChange:n=>c(Vn({metric:e,meta:t.value,newValue:n})),value:void 0!==(null===(n=e.meta)||void 0===n?void 0:n[t.value])?!!(null===(r=e.meta)||void 0===r?void 0:r[t.value]):!!(null===(l=pe.extended_stats.defaults.meta)||void 0===l?void 0:l[t.value])})})),He().createElement(sl,{label:"Sigma",metric:e,settingName:"sigma",placeholder:"3"})),"percentiles"===e.type&&He().createElement(J.InlineField,Tl({label:"Percentiles"},Il),He().createElement(J.Input,{id:`${u}-percentiles-percents`,onBlur:t=>c(Bn({metric:e,settingName:"percents",newValue:t.target.value.split(",").filter(Boolean)})),defaultValue:(null===(i=e.settings)||void 0===i?void 0:i.percents)||(null===(a=pe.percentiles.defaults.settings)||void 0===a?void 0:a.percents),placeholder:"1,5,25,50,75,95,99"})),"rate"===e.type&&He().createElement(He().Fragment,null,He().createElement(J.InlineField,Al(Tl({label:"Unit"},Il),{"data-testid":"unit-select"}),He().createElement(J.Select,{id:`ES-query-${p.refId}_metric-${e.id}-unit`,onChange:t=>c(Bn({metric:e,settingName:"unit",newValue:t.value})),options:[{value:"second",label:"Second"},{value:"minute",label:"Minute"},{value:"hour",label:"Hour"},{value:"day",label:"Day"},{value:"week",label:"Week"},{value:"month",label:"Month"},{value:"quarter",label:"Quarter"},{value:"Year",label:"Year"}],value:null===(o=e.settings)||void 0===o?void 0:o.unit})),He().createElement(J.InlineField,Al(Tl({label:"Mode"},Il),{"data-testid":"mode-select"}),He().createElement(J.Select,{id:`ES-query-${p.refId}_metric-${e.id}-mode`,onChange:t=>c(Bn({metric:e,settingName:"mode",newValue:t.value})),options:[{value:"sum",label:"Sum"},{value:"value_count",label:"Value count"}],value:null===(s=e.settings)||void 0===s?void 0:s.unit}))),(e=>pe[e.type].supportsMissing)(e)&&He().createElement(sl,{label:"Missing",metric:e,settingName:"missing",tooltip:"The missing parameter defines how documents that are missing a value should be treated. By default they will be ignored but it is also possible to treat them as if they had a value"}))},Pl=({stat:e,onChange:n,value:r})=>{const[l]=(0,We.useState)((0,t.uniqueId)("es-field-id-"));return He().createElement(J.InlineField,Al(Tl({label:e.label},Il),{key:e.value}),He().createElement(J.InlineSwitch,{id:l,onChange:e=>n(e.target.checked),value:r}))};function Nl(e,t,n,r,l,i,a){try{var o=e[i](a),s=o.value}catch(e){return void n(e)}o.done?t(s):Promise.resolve(s).then(r,l)}function Cl(e){return function(){var t=this,n=arguments;return new Promise((function(r,l){var i=e.apply(t,n);function a(e){Nl(i,r,l,a,o,"next",e)}function o(e){Nl(i,r,l,a,o,"throw",e)}a(void 0)}))}}const _l=["count","avg","sum","min","max","percentiles","raw_data","logs"],Dl=({value:e})=>{const t=(n=(0,J.useTheme2)(),{color:(r=!!e.hide)&&Xe.css`
        &,
        &:hover,
        label,
        a {
          color: ${r?n.colors.text.disabled:n.colors.text.primary};
        }
      `});var n,r;const l=dr(),i=gt(),a=Tr(e.type),o=(s=Cl((function*(e){return Object.entries(pe).filter((([e,t])=>"metrics"===t.impliedQueryType)).map((([e,{label:t}])=>({label:t,value:e}))).filter((e=>_l.includes(e.value)))})),function(e){return s.apply(this,arguments)});var s;const u=(0,We.useCallback)(Cl((function*(){return yield a()})),[a]),c=l.metrics.slice(0,l.metrics.findIndex((t=>t.id===e.id)));return He().createElement(He().Fragment,null,He().createElement(J.InlineSegmentGroup,null,He().createElement(J.SegmentAsync,{className:(0,Xe.cx)(t.color,Ar),loadOptions:()=>o(c),onChange:t=>i(xn({id:e.id,type:t.value})),value:(f=e,{label:pe[f.type].label,value:f.type})}),oe(e)&&!se(e)&&He().createElement(J.SegmentAsync,{className:(0,Xe.cx)(t.color,Ar),loadOptions:u,onChange:t=>i(jn({id:e.id,field:t.value})),placeholder:"Select Field",value:e.field}),se(e)&&!ue(e)&&He().createElement(ol,{className:(0,Xe.cx)(t.color,Ar),onChange:t=>{var n;return i(jn({id:e.id,field:null===(n=t.value)||void 0===n?void 0:n.id}))},options:c,value:e.field})),ce(e)&&He().createElement(Rl,{metric:e,previousMetrics:c}));var f},Ll=({name:e,metric:t})=>He().createElement(J.InlineFieldRow,null,He().createElement(J.InlineSegmentGroup,null,He().createElement(J.InlineLabel,{width:17,as:"div"},He().createElement("span",null,e))),He().createElement(Rl,{metric:t,previousMetrics:[]})),kl=({nextId:e})=>{var t,n;const r=gt(),{metrics:l}=dr(),i=(null===(t=l)||void 0===t?void 0:t.length)||0;return He().createElement(He().Fragment,null,null===(n=l)||void 0===n?void 0:n.map(((t,n)=>{switch(t.type){case"logs":return He().createElement(Ll,{key:`${t.type}-${t.id}`,name:"Logs",metric:t});case"raw_data":return He().createElement(Ll,{key:`${t.type}-${t.id}`,name:"Raw Data",metric:t});default:return He().createElement(qr,{key:`${t.type}-${t.id}`,label:`Metric (${t.id})`,hidden:t.hide,onHideClick:()=>r(Mn(t.id)),onRemoveClick:i>1&&(()=>r(Fn(t.id)))},He().createElement(Dl,{value:t}),"metrics"===pe[t.type].impliedQueryType&&0===n&&He().createElement(br,{iconName:"plus",onClick:()=>r(kn(e)),label:"add"}))}})))},Fl=[{value:"metrics",label:"Metrics"},{value:"logs",label:"Logs"},{value:"raw_data",label:"Raw Data"}];function Ml(e){switch(e){case"logs":case"raw_data":return e;case"metrics":return"count";default:throw new Error(`invalid query type: ${e}`)}}const jl=()=>{var e;const t=dr(),n=gt(),r=null===(e=t.metrics)||void 0===e?void 0:e[0];if(null==r)return null;const l=pe[r.type].impliedQueryType;return He().createElement(J.RadioButtonGroup,{fullWidth:!1,options:Fl,value:l,onChange:e=>{n(xn({id:r.id,type:Ml(e)}))}})},xl=e=>({root:Xe.css`
    display: flex;
  `,queryItem:Xe.css`
    flex-grow: 1;
    margin: 0 ${e.spacing(.5)} ${e.spacing(.5)} 0;
  `}),Ul=({value:e,onChange:t})=>{const n=(0,J.useStyles2)(xl);return He().createElement("div",{className:n.queryItem},He().createElement(J.QueryField,{query:e,onBlur:()=>{},onChange:t,placeholder:"Enter a lucene query",portalOrigin:"elasticsearch"}))},Bl=({value:e})=>{var t,n;const r=gt(),l=(()=>{const{metrics:e,bucketAggs:t}=dr();return(0,We.useMemo)((()=>{var n,r;return(Math.max(...[...(null===(n=e)||void 0===n?void 0:n.map(mr))||["0"],...(null===(r=t)||void 0===r?void 0:r.map(mr))||["0"]].map(vr))+1).toString()}),[e,t])})(),i=(0,J.useStyles2)(xl),a=null===(t=e.metrics)||void 0===t?void 0:t.every((e=>"metrics"===pe[e.type].impliedQueryType));return He().createElement(He().Fragment,null,He().createElement("div",{className:i.root},He().createElement(J.InlineLabel,{width:17},"Query type"),He().createElement("div",{className:i.queryItem},He().createElement(jl,null))),He().createElement("div",{className:i.root},He().createElement(J.InlineLabel,{width:17},"Lucene Query"),He().createElement(Ul,{onChange:e=>r(Wn(e)),value:null===(n=e)||void 0===n?void 0:n.query})),He().createElement(kl,{nextId:l}),a&&He().createElement(ll,{nextId:l}))},Vl=new e.DataSourcePlugin(De).setConfigEditor((e=>{const{options:t,onOptionsChange:n}=e,r=(e=>Qe(Ke({},e),{jsonData:Qe(Ke({},e.jsonData),{logMessageField:e.jsonData.logMessageField||"",logLevelField:e.jsonData.logLevelField||""})}))(t),l=(0,We.useCallback)((e=>{n(st({},r,e))}),[r,n]);return He().createElement(He().Fragment,null,He().createElement(J.DataSourceHttpSettings,{defaultUrl:"http://localhost:7280/api/v1",dataSourceConfig:r,onChange:n}),He().createElement(ft,{value:r,onChange:l}),He().createElement(ct,{value:r,onChange:n}))})).setQueryEditor((({query:t,onChange:n,onRunQuery:r,datasource:l,range:i,app:a})=>He().createElement(fr,{datasource:l,onChange:n,onRunQuery:r,query:t,app:a,range:i||(0,e.getDefaultTimeRange)()},He().createElement(Bl,{value:t}))))})(),f})()));
//# sourceMappingURL=module.js.map